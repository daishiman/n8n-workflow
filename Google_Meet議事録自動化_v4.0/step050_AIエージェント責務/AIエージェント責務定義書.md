# AIエージェント責務定義書 (Step050)

## ワークフロー名
Google Meet議事録自動化システム

---

## 単一責務の原則（SRP）適用

各AIエージェントは、**1つの明確な責務のみ**を持つように設計されています。

---

## AIエージェント一覧（6個）

| ID | ノード名 | 責務（単一） | 入力 | 出力 | モデル |
|----|---------|-------------|------|------|-------|
| **Step0** | Gemini: 音声文字起こし | M4A音声→日本語テキスト変換のみ | M4Aバイナリ | JSON配列（lines） | Gemini 2.0 Flash |
| **Step1** | Gemini: 文字起こし整形 | フィラー語除去と箇条書き化のみ | チャンク | 整形済みチャンク | Gemini 2.0 Flash |
| **Step2** | Gemini: 議題抽出 | 会話から議題を抽出するのみ | 全文字起こし | 議題リスト | Gemini 2.0 Flash + Memory |
| **Step3** | Gemini: 議題分析 | 決定事項・宿題・保留抽出のみ | 議題データ | 分析結果 | Gemini 2.0 Flash |
| **Step4** | Claude: フォーマット変換 | Markdown議事録生成のみ | 全データ | Markdown | Claude Sonnet 4.5 + Memory |
| **Step5** | Claude: 品質保証 | 議事録検証・補完のみ | Markdown + 元データ | 最終Markdown | Claude Sonnet 4.5 + Memory |

---

## AIエージェント詳細定義

### Step0: Gemini音声文字起こし

**責務**: M4A音声ファイルを日本語テキストに変換する
- ✅ やること: 音声認識、話者分離、タイムスタンプ挿入、句読点挿入
- ❌ やらないこと: テキスト整形、議題抽出、フォーマット変換

**入力**: M4Aバイナリデータ
**出力**: JSON配列（line_id, content, speaker, timestamp）
**System Prompt**: Step020のAI設定書参照

**単一責務の検証**:
- 他の責務への依存: なし（音声認識のみ）
- 出力の再利用性: Step1で再利用
- 変更理由: 音声認識精度の向上のみ

---

### Step1: Gemini文字起こし整形

**責務**: 文字起こしチャンクからフィラー語を除去し、箇条書き化する
- ✅ やること: フィラー語除去（「えー」「あのー」等）、箇条書き化
- ❌ やらないこと: 音声認識、議題抽出、決定事項抽出

**入力**: チャンク（main_text + overlap）
**出力**: 整形済みJSON配列（line_id, content, speaker, timestamp）
**System Prompt**: Step020のAI設定書参照

**単一責務の検証**:
- 他の責務への依存: なし（テキスト整形のみ）
- 出力の再利用性: Step2で再利用
- 変更理由: 整形ロジックの改善のみ
- 並列処理: 各チャンクは独立（Memory不要）

---

### Step2: Gemini議題抽出

**責務**: 統合された文字起こしから会議の議題を自動抽出する
- ✅ やること: 会話の流れ理解、議題の区切り検出、議題タイトル生成、該当行番号記録
- ❌ やらないこと: 文字起こし生成、決定事項抽出、議事録フォーマット変換

**入力**: 統合済みJSON配列（全lines）
**出力**: 議題リスト（meeting_name, agendas: [{agenda_id, title, line_ids}]）
**System Prompt**: Step020のAI設定書参照
**Memory**: Simple Memory（session_key: step2_memory）

**単一責務の検証**:
- 他の責務への依存: なし（議題抽出のみ）
- 出力の再利用性: Step3で再利用
- 変更理由: 議題抽出ロジックの改善のみ
- Memory使用理由: 会話全体の文脈保持

---

### Step3: Gemini議題分析

**責務**: 議題ごとの文字起こしから決定事項・宿題・保留事項を抽出する
- ✅ やること: 決定事項抽出、宿題抽出、保留事項抽出
- ❌ やらないこと: 議題抽出、議事録フォーマット変換、品質検証

**入力**: 議題データ（agenda_id, title, lines）
**出力**: 分析結果（agenda_id, decisions, todos, pending）
**System Prompt**: Step020のAI設定書参照

**単一責務の検証**:
- 他の責務への依存: なし（情報抽出のみ）
- 出力の再利用性: Step4で再利用
- 変更理由: 抽出ロジックの改善のみ
- 並列処理: 各議題は独立（Memory不要）

---

### Step4: Claudeフォーマット変換

**責務**: 全データを統合し、業務要件定義書フォーマットのMarkdown議事録を生成する
- ✅ やること: データ統合、Markdown生成、フォーマット適用
- ❌ やらないこと: 議題抽出、決定事項抽出、品質検証

**入力**: 会議名、議題分析結果、全文字起こし、ファイルメタデータ
**出力**: Markdown議事録
**System Prompt**: Step020のAI設定書参照
**Memory**: Simple Memory（session_key: step4_memory）

**単一責務の検証**:
- 他の責務への依存: なし（フォーマット変換のみ）
- 出力の再利用性: Step5で再利用
- 変更理由: フォーマット仕様変更のみ
- Memory使用理由: データ統合時の文脈保持

---

### Step5: Claude品質保証

**責務**: 生成された議事録の完全性を検証し、不足項目を補完する
- ✅ やること: 完全性検証、不足項目補完、警告生成
- ❌ やらないこと: 議事録生成、議題抽出、決定事項抽出

**入力**: 生成済みMarkdown + 元データ（議題、文字起こし）
**出力**: 最終Markdown + 警告リスト
**System Prompt**: Step020のAI設定書参照
**Memory**: Simple Memory（session_key: step5_memory）

**単一責務の検証**:
- 他の責務への依存: なし（品質検証のみ）
- 出力の再利用性: 最終成果物
- 変更理由: 検証ロジックの改善のみ
- Memory使用理由: 元データとの整合性確認

---

## 責務分離の設計原則

### 1. 入出力の明確化
- 各AIエージェントは明確な入力と出力を持つ
- 入力形式と出力形式は型定義で明示

### 2. 依存関係の最小化
- 他のAIエージェントの内部実装に依存しない
- 出力データのみを次のAIエージェントに渡す

### 3. 変更影響の局所化
- あるAIエージェントの変更が他に影響しない
- プロンプト変更は該当AIエージェントのみ

### 4. 並列処理の容易性
- 独立したAIエージェントは並列実行可能
- Step1とStep3はMemory不要（各チャンク/議題が独立）

### 5. テスト容易性
- 各AIエージェントは独立してテスト可能
- モックデータで単体テスト可能

---

## 次ステップへの引き継ぎ事項

### Step060（パターン適用）への引き継ぎ
- **パターン1**: 並列処理パターン（Step1、Step3）
- **パターン2**: Memory使用パターン（Step2、Step4、Step5）
- **パターン3**: データ変換パターン（Step0、Step1、Step4）
- **パターン4**: 情報抽出パターン（Step2、Step3）
- **パターン5**: 品質保証パターン（Step5）
