{
  "name": "Discordé€£å‹•å‹å­¦è¡“è«–æ–‡è‡ªå‹•æ¤œç´¢ãƒ»RAGæ§‹ç¯‰ã‚·ã‚¹ãƒ†ãƒ  v1.0",
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "discord-paper-search",
        "authentication": "headerAuth",
        "responseMode": "lastNode",
        "options": {}
      },
      "id": "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
      "name": "T001_Discord_Webhookå—ä¿¡",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 1.1,
      "position": [240, 300],
      "webhookId": "discord-paper-search",
      "credentials": {
        "httpHeaderAuth": {
          "id": "1",
          "name": "Discord Webhook Secret"
        }
      },
      "notes": "ã€ãƒˆãƒªã‚¬ãƒ¼å±¤ã€‘Discord Botã‹ã‚‰ã®ãƒ¡ãƒ³ã‚·ãƒ§ãƒ³é€šçŸ¥ã‚’å—ä¿¡\n\nå¿…é ˆãƒ˜ãƒƒãƒ€ãƒ¼: X-Webhook-Secret\nå…¥åŠ›å½¢å¼: Discord message payload (JSON)\n- content: ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å†…å®¹\n- author.id: ãƒ¦ãƒ¼ã‚¶ãƒ¼ID\n- channel_id: ãƒãƒ£ãƒ³ãƒãƒ«ID\n- id: ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ID"
    },

    {
      "parameters": {
        "mode": "manual",
        "duplicateItem": false,
        "assignments": {
          "assignments": [
            {
              "id": "field1",
              "name": "question",
              "value": "={{ $json.content }}",
              "type": "string"
            },
            {
              "id": "field2",
              "name": "user_id",
              "value": "={{ $json.author.id }}",
              "type": "string"
            },
            {
              "id": "field3",
              "name": "channel_id",
              "value": "={{ $json.channel_id }}",
              "type": "string"
            },
            {
              "id": "field4",
              "name": "message_id",
              "value": "={{ $json.id }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "id": "b2c3d4e5-f6a7-8901-bcde-f12345678901",
      "name": "T002_è³ªå•å†…å®¹æŠ½å‡º",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.3,
      "position": [460, 300],
      "notes": "ã€å–å¾—å±¤ã€‘Webhookãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã‹ã‚‰å¿…è¦æƒ…å ±ã‚’æŠ½å‡º\n\nå‡ºåŠ›:\n- question: è³ªå•ãƒ†ã‚­ã‚¹ãƒˆ\n- user_id: ãƒ¦ãƒ¼ã‚¶ãƒ¼ID\n- channel_id: ãƒãƒ£ãƒ³ãƒãƒ«ID\n- message_id: ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ID"
    },

    {
      "parameters": {
        "mode": "runOnceForAllItems",
        "jsCode": "// ğŸ¤– AI: è³ªå•ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ï¼†å­¦è¡“ã‚¯ã‚¨ãƒªæœ€é©åŒ–\n// å½¹å‰²: Discordè³ªå•ã‚’å­¦è¡“æ¤œç´¢ç”¨ã®æœ€é©ãªã‚¯ã‚¨ãƒªã«å¤‰æ›\n\nconst question = $input.first().json.question;\n\nconst systemPrompt = `ã‚ãªãŸã¯å­¦è¡“è«–æ–‡æ¤œç´¢ã®ã‚¨ã‚­ã‚¹ãƒ‘ãƒ¼ãƒˆã§ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è‡ªç„¶è¨€èªã§ã®è³ªå•ã‚’ã€arXivã‚„Semantic Scholarã§åŠ¹æœçš„ã«æ¤œç´¢ã§ãã‚‹å­¦è¡“ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã«å¤‰æ›ã—ã¾ã™ã€‚\n\nã€è²¬å‹™ã€‘\n1. è³ªå•ãŒå­¦è¡“è«–æ–‡æ¤œç´¢ã¨ã—ã¦å¦¥å½“ã‹ã‚’åˆ¤å®š\n2. æœ€é©ãªè‹±èªã®æ¤œç´¢ã‚¯ã‚¨ãƒªã‚’ç”Ÿæˆ\n3. é–¢é€£ã™ã‚‹åŒç¾©èªãƒ»æ‹¡å¼µã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’ææ¡ˆ\n4. è«–æ–‡å–å¾—æ•°ã®æŒ‡å®šãŒã‚ã‚Œã°æŠ½å‡º\n\nã€åˆ¤å®šåŸºæº–ã€‘\n- å­¦è¡“çš„ãªãƒˆãƒ”ãƒƒã‚¯ã‹ï¼ˆæŠ€è¡“ã€ç§‘å­¦ã€åŒ»å­¦ã€å·¥å­¦ã€ç¤¾ä¼šç§‘å­¦ç­‰ï¼‰\n- å…·ä½“çš„ãªè³ªå•ã‹ï¼ˆæ›–æ˜§ã™ããªã„ã‹ï¼‰\n- è«–æ–‡æ¤œç´¢ã§å›ç­”å¯èƒ½ãªå†…å®¹ã‹\n\nã€å‡ºåŠ›å½¢å¼ã€‘å¿…ãšJSONå½¢å¼ã§å‡ºåŠ›`;\n\nconst userPrompt = `ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è³ªå•ã€‘\n\"${question}\"\n\nã€ã‚¿ã‚¹ã‚¯ã€‘\nã“ã®è³ªå•ã«ã¤ã„ã¦ä»¥ä¸‹ã‚’åˆ¤å®šã—ã€JSONå½¢å¼ã§å‡ºåŠ›:\n\n{\n  \"is_valid\": true/false,\n  \"validation_reason\": \"åˆ¤å®šç†ç”±\",\n  \"search_query\": \"è‹±èªã®å­¦è¡“ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ï¼ˆ3-6å˜èªï¼‰\",\n  \"expanded_keywords\": [\"åŒç¾©èª1\", \"é–¢é€£èª2\"],\n  \"paper_count\": æ•°å€¤ã¾ãŸã¯5\n}\n\nã€ä¾‹ã€‘\nè³ªå•: \"é‡å­ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã®æœ€æ–°å‹•å‘ã«ã¤ã„ã¦\"\nå‡ºåŠ›:\n{\n  \"is_valid\": true,\n  \"validation_reason\": \"å…·ä½“çš„ãªå­¦è¡“ãƒˆãƒ”ãƒƒã‚¯ã§è«–æ–‡æ¤œç´¢ã«é©ã—ã¦ã„ã‚‹\",\n  \"search_query\": \"quantum computing recent advances\",\n  \"expanded_keywords\": [\"quantum algorithms\", \"qubit\", \"quantum supremacy\"],\n  \"paper_count\": 5\n}`;\n\nconst response = await fetch('https://api.openai.com/v1/chat/completions', {\n  method: 'POST',\n  headers: {\n    'Authorization': `Bearer ${$credentials.openAiApi.apiKey}`,\n    'Content-Type': 'application/json'\n  },\n  body: JSON.stringify({\n    model: 'gpt-4o-mini',\n    messages: [\n      { role: 'system', content: systemPrompt },\n      { role: 'user', content: userPrompt }\n    ],\n    response_format: { type: 'json_object' },\n    temperature: 0.3,\n    max_tokens: 800\n  })\n});\n\nif (!response.ok) {\n  throw new Error(`OpenAI API Error: ${response.status}`);\n}\n\nconst data = await response.json();\nconst result = JSON.parse(data.choices[0].message.content);\n\nif (!result.is_valid) {\n  throw new Error(`Invalid question: ${result.validation_reason}`);\n}\n\nreturn [{\n  json: {\n    ...result,\n    original_question: question,\n    user_id: $input.first().json.user_id,\n    channel_id: $input.first().json.channel_id,\n    message_id: $input.first().json.message_id\n  }\n}];"
      },
      "id": "c3d4e5f6-a7b8-9012-cdef-123456789012",
      "name": "T003_è³ªå•ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ï¼†ã‚¯ã‚¨ãƒªæœ€é©åŒ–",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [680, 300],
      "credentials": {
        "openAiApi": {
          "id": "2",
          "name": "OpenAI API Key"
        }
      },
      "onError": "stopWorkflow",
      "retryOnFail": true,
      "maxTries": 2,
      "waitBetweenTries": 5000,
      "notes": "ğŸ¤– ã€AIã€‘è³ªå•ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ï¼†å­¦è¡“ã‚¯ã‚¨ãƒªæœ€é©åŒ–\n\nã€å½¹å‰²ã€‘\nè‡ªç„¶è¨€èªã®è³ªå•ã‚’å­¦è¡“æ¤œç´¢ç”¨ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã«å¤‰æ›\n\nã€å…¥åŠ›ã€‘\n- question: Discordè³ªå•ãƒ†ã‚­ã‚¹ãƒˆ\n\nã€å‡ºåŠ›ã€‘\n- is_valid: boolean\n- search_query: è‹±èªã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰\n- expanded_keywords: é–¢é€£èªé…åˆ—\n- paper_count: 1-20ï¼ˆdefault: 5ï¼‰\n\nã€ãƒ¢ãƒ‡ãƒ«ã€‘gpt-4o-mini\nã€ã‚³ã‚¹ãƒˆã€‘$0.001-0.002/å®Ÿè¡Œ"
    },

    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict"
          },
          "conditions": [
            {
              "id": "condition1",
              "leftValue": "={{ $json.paper_count }}",
              "rightValue": "",
              "operator": {
                "type": "number",
                "operation": "exists"
              }
            },
            {
              "id": "condition2",
              "leftValue": "={{ $json.paper_count }}",
              "rightValue": 1,
              "operator": {
                "type": "number",
                "operation": "gte"
              }
            },
            {
              "id": "condition3",
              "leftValue": "={{ $json.paper_count }}",
              "rightValue": 20,
              "operator": {
                "type": "number",
                "operation": "lte"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "d4e5f6a7-b8c9-0123-def0-234567890123",
      "name": "T004_è«–æ–‡æ•°åˆ¤å®š",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [900, 300],
      "notes": "ã€åˆ¤æ–­å±¤ã€‘è«–æ–‡å–å¾—æ•°ã®æ±ºå®š\n\næ¡ä»¶:\n- paper_countå­˜åœ¨ AND 1-20ã®ç¯„å›² â†’ æŒ‡å®šä»¶æ•°\n- ãã‚Œä»¥å¤– â†’ ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ5ä»¶\n\nä¸¡ãƒ–ãƒ©ãƒ³ãƒã¨ã‚‚T005, T006ã«æ¥ç¶š"
    },

    {
      "parameters": {
        "method": "GET",
        "url": "=https://export.arxiv.org/api/query?search_query=all:{{ encodeURIComponent($json.search_query) }}&start=0&max_results={{ $json.paper_count || 5 }}&sortBy=relevance&sortOrder=descending",
        "authentication": "none",
        "options": {
          "timeout": 30000,
          "response": {
            "response": {
              "responseFormat": "text"
            }
          }
        }
      },
      "id": "e5f6a7b8-c9d0-1234-ef01-345678901234",
      "name": "T005_arXivè«–æ–‡æ¤œç´¢",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [1120, 180],
      "onError": "continueErrorOutput",
      "retryOnFail": true,
      "maxTries": 3,
      "waitBetweenTries": 10000,
      "notes": "ã€å–å¾—å±¤ãƒ»ä¸¦åˆ—å®Ÿè¡Œã€‘arXiv APIã‹ã‚‰è«–æ–‡æ¤œç´¢\n\nAPI: https://export.arxiv.org/api/query\nèªè¨¼: ä¸è¦\nãƒ¬ãƒ¼ãƒˆåˆ¶é™: ãªã—ï¼ˆæ¨å¥¨3ç§’é–“éš”ï¼‰\nå‡ºåŠ›å½¢å¼: XMLï¼ˆå¾Œã§JSONå¤‰æ›ãŒå¿…è¦ï¼‰\n\nä¸¦åˆ—å®Ÿè¡Œ: T006ã¨åŒæ™‚å®Ÿè¡Œ"
    },

    {
      "parameters": {
        "method": "GET",
        "url": "=https://api.semanticscholar.org/graph/v1/paper/search?query={{ encodeURIComponent($json.search_query) }}&limit={{ $json.paper_count || 5 }}&fields=paperId,title,authors,abstract,url,year,openAccessPdf",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "options": {
          "timeout": 30000
        }
      },
      "id": "f6a7b8c9-d0e1-2345-f012-456789012345",
      "name": "T006_Semantic_Scholarè«–æ–‡æ¤œç´¢",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [1120, 420],
      "credentials": {
        "httpHeaderAuth": {
          "id": "3",
          "name": "Semantic Scholar API Key"
        }
      },
      "onError": "continueErrorOutput",
      "retryOnFail": true,
      "maxTries": 3,
      "waitBetweenTries": 10000,
      "notes": "ã€å–å¾—å±¤ãƒ»ä¸¦åˆ—å®Ÿè¡Œã€‘Semantic Scholar APIã‹ã‚‰è«–æ–‡æ¤œç´¢\n\nAPI: https://api.semanticscholar.org\nèªè¨¼: API Keyï¼ˆx-api-key headerï¼‰\nãƒ¬ãƒ¼ãƒˆåˆ¶é™: 100ãƒªã‚¯ã‚¨ã‚¹ãƒˆ/5åˆ†\nå‡ºåŠ›å½¢å¼: JSON\n\nä¸¦åˆ—å®Ÿè¡Œ: T005ã¨åŒæ™‚å®Ÿè¡Œ"
    },

    {
      "parameters": {
        "amount": 3,
        "unit": "seconds"
      },
      "id": "a7b8c9d0-e1f2-3456-0123-567890123456",
      "name": "T007_ãƒ¬ãƒ¼ãƒˆåˆ¶é™Wait",
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [1340, 300],
      "webhookBasedExecution": false,
      "notes": "ã€å–å¾—å±¤ã€‘ä¸¦åˆ—APIå‘¼ã³å‡ºã—å¾Œã®å¾…æ©Ÿ\n\nå¾…æ©Ÿæ™‚é–“: 3ç§’\nç†ç”±: APIä¿è­·ã¨ãƒ¬ãƒ¼ãƒˆåˆ¶é™å¯¾ç­–"
    },

    {
      "parameters": {
        "mode": "runOnceForAllItems",
        "jsCode": "// è«–æ–‡ãƒ‡ãƒ¼ã‚¿çµ±åˆãƒ»æ­£è¦åŒ–\n// å½¹å‰²: arXivã¨Semantic Scholarã®ç•°ãªã‚‹ã‚¹ã‚­ãƒ¼ãƒã‚’çµ±ä¸€\n\nconst allItems = $input.all();\nconst papers = [];\n\n// å„ã‚¢ã‚¤ãƒ†ãƒ ã‚’å‡¦ç†\nfor (const item of allItems) {\n  const data = item.json;\n  \n  // arXivãƒ‡ãƒ¼ã‚¿ã®å‡¦ç†ï¼ˆXMLâ†’JSONå¤‰æ›æ¸ˆã¿ã¨ä»®å®šï¼‰\n  if (data.feed && data.feed.entry) {\n    const entries = Array.isArray(data.feed.entry) ? data.feed.entry : [data.feed.entry];\n    for (const entry of entries) {\n      papers.push({\n        title: entry.title?.replace(/\\n/g, ' ').trim(),\n        authors: entry.author ? (Array.isArray(entry.author) ? entry.author.map(a => a.name) : [entry.author.name]) : [],\n        abstract: entry.summary?.replace(/\\n/g, ' ').trim(),\n        pdf_url: entry.link?.find(l => l.$.type === 'application/pdf')?.$?.href || entry.link?.[1]?.$?.href,\n        arxiv_id: entry.id?.split('/').pop()?.split('v')[0],\n        published_date: entry.published,\n        source: 'arxiv',\n        relevance_score: 1.0\n      });\n    }\n  }\n  \n  // Semantic Scholarãƒ‡ãƒ¼ã‚¿ã®å‡¦ç†\n  if (data.data) {\n    for (const paper of data.data) {\n      papers.push({\n        title: paper.title,\n        authors: paper.authors?.map(a => a.name) || [],\n        abstract: paper.abstract || '',\n        pdf_url: paper.openAccessPdf?.url || paper.url,\n        semantic_scholar_id: paper.paperId,\n        published_date: paper.year?.toString(),\n        source: 'semantic_scholar',\n        relevance_score: 1.0\n      });\n    }\n  }\n}\n\n// å¿…é ˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã§ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°\nconst validPapers = papers.filter(p => \n  p.title && \n  p.authors && p.authors.length > 0 && \n  p.pdf_url && \n  p.abstract\n);\n\nconsole.log(`çµ±åˆå®Œäº†: ${papers.length}ä»¶ä¸­${validPapers.length}ä»¶ãŒæœ‰åŠ¹`);\n\nreturn validPapers.map(p => ({ json: p }));"
      },
      "id": "b8c9d0e1-f2a3-4567-1234-678901234567",
      "name": "T008_è«–æ–‡ãƒ‡ãƒ¼ã‚¿çµ±åˆãƒ»æ­£è¦åŒ–",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [1560, 300],
      "notes": "ã€çµ±åˆå±¤ã€‘ç•°ãªã‚‹APIã‚¹ã‚­ãƒ¼ãƒã®çµ±ä¸€\n\nå…¥åŠ›:\n- arXiv: XMLå½¢å¼\n- Semantic Scholar: JSONå½¢å¼\n\nå‡ºåŠ›:\nçµ±ä¸€ã‚¹ã‚­ãƒ¼ãƒ\n- title: string\n- authors: array\n- abstract: string\n- pdf_url: string\n- arxiv_id/semantic_scholar_id: string\n- published_date: string\n- source: arxiv | semantic_scholar"
    },

    {
      "parameters": {
        "mode": "runOnceForAllItems",
        "jsCode": "// ğŸ¤– AI: é‡è¤‡æ’é™¤ï¼†é–¢é€£åº¦ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°\n// å½¹å‰²: è¤‡æ•°ã‚½ãƒ¼ã‚¹ã®è«–æ–‡ã‚’çµ±åˆè©•ä¾¡ã—ã€é–¢é€£åº¦é †ã«ãƒ©ãƒ³ã‚­ãƒ³ã‚°\n\nconst papers = $input.all().map(item => item.json);\nconst originalQuestion = $('T003_è³ªå•ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ï¼†ã‚¯ã‚¨ãƒªæœ€é©åŒ–').first().json.original_question;\nconst searchQuery = $('T003_è³ªå•ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ï¼†ã‚¯ã‚¨ãƒªæœ€é©åŒ–').first().json.search_query;\n\n// è«–æ–‡IDã§é‡è¤‡æ’é™¤\nconst uniquePapers = [];\nconst seenIds = new Set();\n\nfor (const paper of papers) {\n  const id = paper.arxiv_id || paper.semantic_scholar_id || paper.title;\n  if (!seenIds.has(id)) {\n    seenIds.add(id);\n    uniquePapers.push(paper);\n  }\n}\n\nconsole.log(`é‡è¤‡æ’é™¤: ${papers.length}ä»¶ â†’ ${uniquePapers.length}ä»¶`);\n\n// AIã§é–¢é€£åº¦è©•ä¾¡\nconst systemPrompt = `ã‚ãªãŸã¯å­¦è¡“è«–æ–‡ã®é–¢é€£åº¦ã‚’è©•ä¾¡ã™ã‚‹å°‚é–€å®¶ã§ã™ã€‚\n\nã€è²¬å‹™ã€‘\n1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è³ªå•ã«å¯¾ã™ã‚‹å„è«–æ–‡ã®é–¢é€£åº¦ã‚’è©•ä¾¡\n2. 0-1ã®ã‚¹ã‚³ã‚¢ã§å®šé‡åŒ–\n3. æœ€ã‚‚é–¢é€£æ€§ã®é«˜ã„é †ã«ãƒ©ãƒ³ã‚­ãƒ³ã‚°\n\nã€è©•ä¾¡åŸºæº–ã€‘\n- ã‚¿ã‚¤ãƒˆãƒ«ã¨è³ªå•ã®ä¸€è‡´åº¦ï¼ˆ30%ï¼‰\n- Abstractã¨è³ªå•ã®é–¢é€£åº¦ï¼ˆ50%ï¼‰\n- ç™ºè¡Œå¹´ï¼ˆæ–°ã—ã„ã»ã©åŠ ç‚¹ã€10%ï¼‰\n- è‘—è€…ãƒ»å¼•ç”¨æ•°ï¼ˆä¿¡é ¼æ€§ã€10%ï¼‰\n\nã€ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°ã€‘\n0.9-1.0: æ¥µã‚ã¦é–¢é€£æ€§ãŒé«˜ã„\n0.7-0.89: é–¢é€£æ€§ãŒé«˜ã„\n0.5-0.69: ã‚„ã‚„é–¢é€£æ€§ã‚ã‚Š\n0.3-0.49: é–¢é€£æ€§ãŒä½ã„`;\n\nconst userPrompt = `ã€å…ƒã®è³ªå•ã€‘\"${originalQuestion}\"\nã€æ¤œç´¢ã‚¯ã‚¨ãƒªã€‘\"${searchQuery}\"\n\nã€è«–æ–‡ãƒªã‚¹ãƒˆã€‘\n${uniquePapers.map((p, i) => `${i}. ${p.title}\\nAbstract: ${p.abstract?.substring(0, 200)}...`).join('\\n\\n')}\n\nã€ã‚¿ã‚¹ã‚¯ã€‘å„è«–æ–‡ã®é–¢é€£åº¦ã‚’0-1ã§è©•ä¾¡:\n{\n  \"scores\": [\n    {\"index\": 0, \"score\": 0.95, \"reasoning\": \"ç†ç”±\"},\n    {\"index\": 1, \"score\": 0.82, \"reasoning\": \"ç†ç”±\"}\n  ]\n}`;\n\nconst response = await fetch('https://api.openai.com/v1/chat/completions', {\n  method: 'POST',\n  headers: {\n    'Authorization': `Bearer ${$credentials.openAiApi.apiKey}`,\n    'Content-Type': 'application/json'\n  },\n  body: JSON.stringify({\n    model: 'gpt-4o-mini',\n    messages: [\n      { role: 'system', content: systemPrompt },\n      { role: 'user', content: userPrompt }\n    ],\n    response_format: { type: 'json_object' },\n    temperature: 0.3,\n    max_tokens: 2000\n  })\n});\n\nif (!response.ok) {\n  console.log('AIã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°å¤±æ•—ã€å…ƒã®ã‚¹ã‚³ã‚¢ã‚’ä½¿ç”¨');\n  // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯: å…ƒã®ã‚¹ã‚³ã‚¢ã§ã‚½ãƒ¼ãƒˆ\n  const topPapers = uniquePapers\n    .sort((a, b) => b.relevance_score - a.relevance_score)\n    .slice(0, $('T003_è³ªå•ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ï¼†ã‚¯ã‚¨ãƒªæœ€é©åŒ–').first().json.paper_count || 5);\n  return topPapers.map(p => ({ json: p }));\n}\n\nconst data = await response.json();\nconst result = JSON.parse(data.choices[0].message.content);\n\n// ã‚¹ã‚³ã‚¢ã‚’é©ç”¨\nfor (let i = 0; i < uniquePapers.length && i < result.scores.length; i++) {\n  uniquePapers[i].relevance_score = result.scores[i].score;\n  uniquePapers[i].score_reasoning = result.scores[i].reasoning;\n}\n\n// é–¢é€£åº¦é †ã«ã‚½ãƒ¼ãƒˆã—ã¦ä¸Šä½Nä»¶\nconst paperCount = $('T003_è³ªå•ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ï¼†ã‚¯ã‚¨ãƒªæœ€é©åŒ–').first().json.paper_count || 5;\nconst topPapers = uniquePapers\n  .sort((a, b) => b.relevance_score - a.relevance_score)\n  .slice(0, paperCount);\n\nconsole.log(`ãƒˆãƒƒãƒ—${paperCount}ä»¶é¸æŠå®Œäº†`);\n\nreturn topPapers.map(p => ({ json: p }));"
      },
      "id": "c9d0e1f2-a3b4-5678-2345-789012345678",
      "name": "T009_é‡è¤‡æ’é™¤ï¼†é–¢é€£åº¦ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [1780, 300],
      "credentials": {
        "openAiApi": {
          "id": "2",
          "name": "OpenAI API Key"
        }
      },
      "onError": "continueRegularOutput",
      "retryOnFail": true,
      "maxTries": 2,
      "waitBetweenTries": 5000,
      "notes": "ğŸ¤– ã€AIã€‘é‡è¤‡æ’é™¤ï¼†é–¢é€£åº¦ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°\n\nã€å½¹å‰²ã€‘\nè¤‡æ•°ã‚½ãƒ¼ã‚¹ã®è«–æ–‡ã‚’çµ±åˆè©•ä¾¡ã—æœ€çµ‚ãƒ©ãƒ³ã‚­ãƒ³ã‚°æ±ºå®š\n\nã€å‡¦ç†ã€‘\n1. è«–æ–‡IDã§é‡è¤‡æ’é™¤\n2. AIã§é–¢é€£åº¦ã‚’0-1ã‚¹ã‚³ã‚¢åŒ–\n3. ä¸Šä½Nä»¶ã‚’é¸æŠ\n\nã€ãƒ¢ãƒ‡ãƒ«ã€‘gpt-4o-mini\nã€ã‚³ã‚¹ãƒˆã€‘$0.002-0.004/å®Ÿè¡Œ"
    },

    {
      "parameters": {
        "mode": "runOnceForAllItems",
        "jsCode": "// è«–æ–‡ãƒ‡ãƒ¼ã‚¿ã®å¿…é ˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰æ¤œè¨¼\nconst papers = $input.all().map(item => item.json);\n\nconst validPapers = papers.filter(paper => {\n  const hasTitle = paper.title && paper.title.length > 0;\n  const hasAuthors = paper.authors && paper.authors.length > 0;\n  const hasPdfUrl = paper.pdf_url && (paper.pdf_url.startsWith('http://') || paper.pdf_url.startsWith('https://'));\n  const hasAbstract = paper.abstract && paper.abstract.length > 50;\n  \n  return hasTitle && hasAuthors && hasPdfUrl && hasAbstract;\n});\n\nconsole.log(`ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³å®Œäº†: ${papers.length}ä»¶ä¸­${validPapers.length}ä»¶ãŒæœ‰åŠ¹`);\n\nif (validPapers.length === 0) {\n  throw new Error('æœ‰åŠ¹ãªè«–æ–‡ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ');\n}\n\nreturn validPapers.map(p => ({ json: p }));"
      },
      "id": "d0e1f2a3-b4c5-6789-3456-890123456789",
      "name": "T010_è«–æ–‡ãƒ‡ãƒ¼ã‚¿ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [2000, 300],
      "notes": "ã€æ¤œè¨¼å±¤ã€‘å¿…é ˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®å­˜åœ¨ç¢ºèª\n\nãƒã‚§ãƒƒã‚¯é …ç›®:\nâœ“ ã‚¿ã‚¤ãƒˆãƒ«å­˜åœ¨\nâœ“ è‘—è€…é…åˆ—å­˜åœ¨\nâœ“ PDF URLå½¢å¼æ­£å¸¸\nâœ“ Abstract 50æ–‡å­—ä»¥ä¸Š\n\nä¸å®Œå…¨ãªãƒ‡ãƒ¼ã‚¿ã‚’é™¤å¤–"
    },

    {
      "parameters": {
        "batchSize": 1,
        "options": {}
      },
      "id": "e1f2a3b4-c5d6-7890-4567-901234567890",
      "name": "T011_PDFãƒãƒƒãƒåˆ†å‰²",
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [2220, 300],
      "notes": "ã€ãƒ«ãƒ¼ãƒ—é–‹å§‹ã€‘è«–æ–‡ã‚’1ä»¶ãšã¤å‡¦ç†\n\nãƒãƒƒãƒã‚µã‚¤ã‚º: 1ä»¶\nç†ç”±: å€‹åˆ¥è«–æ–‡ã®å¤±æ•—ãŒå…¨ä½“ã«å½±éŸ¿ã—ãªã„\n\nãƒ«ãƒ¼ãƒ—ãƒ•ãƒ­ãƒ¼:\nT011 â†’ T012-T020 â†’ T011ï¼ˆæ¬¡ã®ãƒãƒƒãƒï¼‰\nå…¨ãƒãƒƒãƒå®Œäº† â†’ T021"
    },

    {
      "parameters": {
        "method": "GET",
        "url": "={{ $json.pdf_url }}",
        "authentication": "none",
        "options": {
          "timeout": 60000,
          "response": {
            "response": {
              "responseFormat": "file",
              "outputPropertyName": "data"
            }
          }
        }
      },
      "id": "f2a3b4c5-d6e7-8901-5678-012345678901",
      "name": "T012_PDFå–å¾—",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [2440, 300],
      "onError": "continueErrorOutput",
      "retryOnFail": true,
      "maxTries": 3,
      "waitBetweenTries": 15000,
      "notes": "ã€å–å¾—å±¤ãƒ»ãƒ«ãƒ¼ãƒ—å†…ã€‘è«–æ–‡PDFãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰\n\nã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ: 60ç§’\nãƒªãƒˆãƒ©ã‚¤: 3å›ï¼ˆ15ç§’é–“éš”ï¼‰\nå‡ºåŠ›: Binary PDF\n\nå‡¦ç†æ™‚é–“: 5-10ç§’/ä»¶"
    },

    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict"
          },
          "conditions": [
            {
              "id": "condition1",
              "leftValue": "={{ $binary.data }}",
              "rightValue": "",
              "operator": {
                "type": "object",
                "operation": "exists"
              }
            },
            {
              "id": "condition2",
              "leftValue": "={{ $json.error }}",
              "rightValue": "",
              "operator": {
                "type": "any",
                "operation": "notExists"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "a3b4c5d6-e7f8-9012-6789-123456789012",
      "name": "T013_PDFå–å¾—å¯å¦åˆ¤å®š",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [2660, 300],
      "notes": "ã€åˆ¤æ–­å±¤ãƒ»ãƒ«ãƒ¼ãƒ—å†…ã€‘PDFå–å¾—æˆåŠŸ/å¤±æ•—åˆ¤å®š\n\næˆåŠŸãƒ–ãƒ©ãƒ³ãƒ:\nâ†’ T014ï¼ˆGoogle Driveä¿å­˜ï¼‰ã¸\n\nå¤±æ•—ãƒ–ãƒ©ãƒ³ãƒ:\nâ†’ T025ï¼ˆã‚¨ãƒ©ãƒ¼ãƒ­ã‚°è¨˜éŒ²ï¼‰ã¸\n\nä¸¡ãƒ–ãƒ©ãƒ³ãƒã¨ã‚‚T020ã§åˆæµ"
    },

    {
      "parameters": {
        "operation": "upload",
        "folderId": {
          "__rl": true,
          "value": "={{ 'è«–æ–‡ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–/' + $now.toFormat('yyyy-MM-dd') }}",
          "mode": "name",
          "cachedResultName": "è«–æ–‡ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–"
        },
        "name": "={{ $json.title.replace(/[^a-zA-Z0-9\\s\\-_]/g, '').substring(0, 100) }}.pdf",
        "resolveData": true,
        "options": {},
        "binaryData": true,
        "binaryPropertyName": "data"
      },
      "id": "b4c5d6e7-f8a9-0123-7890-234567890123",
      "name": "T014_Google_Driveä¿å­˜",
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [2880, 200],
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "4",
          "name": "Google Drive OAuth2"
        }
      },
      "onError": "continueErrorOutput",
      "retryOnFail": true,
      "maxTries": 3,
      "waitBetweenTries": 10000,
      "notes": "ã€å®Ÿè¡Œå±¤ãƒ»ãƒ«ãƒ¼ãƒ—å†…ã€‘PDFã‚’Google Driveã«ä¿å­˜\n\nãƒ•ã‚©ãƒ«ãƒ€æ§‹é€ :\n/è«–æ–‡ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–/YYYY-MM-DD/ã‚¿ã‚¤ãƒˆãƒ«.pdf\n\nãƒ•ã‚¡ã‚¤ãƒ«å:\n- ç‰¹æ®Šæ–‡å­—é™¤å»\n- æœ€å¤§100æ–‡å­—\n- .pdfæ‹¡å¼µå­\n\nå‡ºåŠ›:\n- file_id: string\n- webViewLink: stringï¼ˆDrive URLï¼‰"
    },

    {
      "parameters": {
        "mode": "runOnceForEachItem",
        "jsCode": "// PDFâ†’ãƒ†ã‚­ã‚¹ãƒˆæŠ½å‡º\n// æ³¨: å®Ÿéš›ã®å®Ÿè£…ã§ã¯pdf-parseãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒå¿…è¦\n// ã“ã“ã§ã¯æ§‹é€ ã‚’ç¤ºã™ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼\n\nconst pdfBinary = $binary.data;\n\n// å®Ÿè£…ãƒ¡ãƒ¢:\n// const pdf = require('pdf-parse');\n// const dataBuffer = Buffer.from(pdfBinary, 'base64');\n// const data = await pdf(dataBuffer);\n// const fullText = data.text;\n\n// ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼å®Ÿè£…\nconst extracted = {\n  full_text: $json.abstract + \"\\n\\n[PDFã‹ã‚‰æŠ½å‡ºã•ã‚ŒãŸæœ¬æ–‡ãŒã“ã“ã«å…¥ã‚Šã¾ã™ã€‚å®Ÿéš›ã®å®Ÿè£…ã§ã¯pdf-parseãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ç”¨ã—ã¦ãã ã•ã„ã€‚]\",\n  abstract: $json.abstract,\n  metadata: {\n    title: $json.title,\n    authors: $json.authors,\n    published_date: $json.published_date,\n    arxiv_id: $json.arxiv_id,\n    semantic_scholar_id: $json.semantic_scholar_id\n  }\n};\n\nreturn {\n  json: {\n    ...extracted,\n    paper_info: $json,\n    drive_url: $('T014_Google_Driveä¿å­˜').first().json.webViewLink\n  }\n};"
      },
      "id": "c5d6e7f8-a9b0-1234-8901-345678901234",
      "name": "T015_PDFâ†’ãƒ†ã‚­ã‚¹ãƒˆæŠ½å‡º",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [3100, 200],
      "onError": "continueErrorOutput",
      "retryOnFail": true,
      "maxTries": 2,
      "waitBetweenTries": 5000,
      "notes": "ã€å¤‰æ›å±¤ãƒ»ãƒ«ãƒ¼ãƒ—å†…ã€‘PDFã‹ã‚‰æœ¬æ–‡æŠ½å‡º\n\nå‡ºåŠ›:\n- full_text: è«–æ–‡å…¨æ–‡\n- abstract: è¦ç´„\n- metadata: ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿\n\nå‡¦ç†æ™‚é–“: 5-10ç§’/ä»¶\n\næ³¨æ„: å®Ÿéš›ã®å®Ÿè£…ã§ã¯pdf-parseãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒå¿…è¦"
    },

    {
      "parameters": {
        "mode": "runOnceForEachItem",
        "jsCode": "// ğŸ¤– AI: ãƒ†ã‚­ã‚¹ãƒˆãƒãƒ£ãƒ³ã‚¯åˆ†å‰²ï¼ˆã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯ï¼‰\n// å½¹å‰²: è«–æ–‡ã‚’æ„å‘³ã®ã‚ã‚‹å˜ä½ã§1000-1500ãƒˆãƒ¼ã‚¯ãƒ³ã®ãƒãƒ£ãƒ³ã‚¯ã«åˆ†å‰²\n\nconst fullText = $json.full_text;\nconst title = $json.metadata.title;\n\nconst systemPrompt = `ã‚ãªãŸã¯å­¦è¡“è«–æ–‡ã®æ§‹é€ ã‚’ç†è§£ã—ã€æ„å‘³ã®ã‚ã‚‹å˜ä½ã§ãƒ†ã‚­ã‚¹ãƒˆã‚’åˆ†å‰²ã™ã‚‹å°‚é–€å®¶ã§ã™ã€‚\n\nã€è²¬å‹™ã€‘\n1. è«–æ–‡ã‚’æ®µè½ãƒ»ã‚»ã‚¯ã‚·ãƒ§ãƒ³å˜ä½ã§åˆ†å‰²\n2. å„ãƒãƒ£ãƒ³ã‚¯ãŒ1000-1500ãƒˆãƒ¼ã‚¯ãƒ³\n3. æ–‡è„ˆã®é€£ç¶šæ€§ã‚’ä¿ã¤\n4. ã‚»ã‚¯ã‚·ãƒ§ãƒ³åã‚’ç‰¹å®š\n\nã€åˆ†å‰²åŸå‰‡ã€‘\n- ã‚»ã‚¯ã‚·ãƒ§ãƒ³å¢ƒç•Œã‚’å„ªå…ˆ\n- æ®µè½ã®é€”ä¸­ã§åˆ‡ã‚‰ãªã„\n- æ–‡ã®é€”ä¸­ã§åˆ‡ã‚‰ãªã„\n\nå‡ºåŠ›: JSONé…åˆ—`;\n\nconst userPrompt = `ã€è«–æ–‡ã‚¿ã‚¤ãƒˆãƒ«ã€‘\"${title}\"\n\nã€æœ¬æ–‡ã€‘\n${fullText.substring(0, 20000)}\n\nã€ã‚¿ã‚¹ã‚¯ã€‘æ„å‘³ã®ã‚ã‚‹å˜ä½ã§1000-1500ãƒˆãƒ¼ã‚¯ãƒ³ã®ãƒãƒ£ãƒ³ã‚¯ã«åˆ†å‰²:\n{\n  \"chunks\": [\n    {\n      \"chunk_index\": 0,\n      \"text\": \"ãƒãƒ£ãƒ³ã‚¯å…¨æ–‡\",\n      \"section\": \"Abstract\",\n      \"token_count\": 1200\n    }\n  ],\n  \"total_chunks\": 5\n}\n\né‡è¦: textãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«ã¯å…ƒã®ãƒ†ã‚­ã‚¹ãƒˆã‚’ãã®ã¾ã¾å«ã‚ã‚‹`;\n\nconst response = await fetch('https://api.openai.com/v1/chat/completions', {\n  method: 'POST',\n  headers: {\n    'Authorization': `Bearer ${$credentials.openAiApi.apiKey}`,\n    'Content-Type': 'application/json'\n  },\n  body: JSON.stringify({\n    model: 'gpt-4o-mini',\n    messages: [\n      { role: 'system', content: systemPrompt },\n      { role: 'user', content: userPrompt }\n    ],\n    response_format: { type: 'json_object' },\n    temperature: 0.3,\n    max_tokens: 4000\n  })\n});\n\nif (!response.ok) {\n  // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯: å˜ç´”ãªæ–‡å­—æ•°åˆ†å‰²\n  const chunkSize = 4000; // ç´„1000ãƒˆãƒ¼ã‚¯ãƒ³\n  const chunks = [];\n  for (let i = 0; i < fullText.length; i += chunkSize) {\n    chunks.push({\n      chunk_index: Math.floor(i / chunkSize),\n      text: fullText.substring(i, i + chunkSize),\n      section: 'Unknown',\n      token_count: Math.floor(chunkSize / 4)\n    });\n  }\n  return {\n    json: {\n      chunks: chunks,\n      paper_info: $json.paper_info,\n      metadata: $json.metadata,\n      drive_url: $json.drive_url\n    }\n  };\n}\n\nconst data = await response.json();\nconst result = JSON.parse(data.choices[0].message.content);\n\nreturn {\n  json: {\n    chunks: result.chunks || [],\n    paper_info: $json.paper_info,\n    metadata: $json.metadata,\n    drive_url: $json.drive_url\n  }\n};"
      },
      "id": "d6e7f8a9-b0c1-2345-9012-456789012345",
      "name": "T016_ãƒ†ã‚­ã‚¹ãƒˆãƒãƒ£ãƒ³ã‚¯åˆ†å‰²",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [3320, 200],
      "credentials": {
        "openAiApi": {
          "id": "2",
          "name": "OpenAI API Key"
        }
      },
      "onError": "continueRegularOutput",
      "retryOnFail": true,
      "maxTries": 2,
      "waitBetweenTries": 5000,
      "notes": "ğŸ¤– ã€AIã€‘ãƒ†ã‚­ã‚¹ãƒˆãƒãƒ£ãƒ³ã‚¯åˆ†å‰²\n\nã€å½¹å‰²ã€‘\næ®µè½ãƒ»ã‚»ã‚¯ã‚·ãƒ§ãƒ³å˜ä½ã§æ„å‘³ã‚’ä¿ã¡ãªãŒã‚‰åˆ†å‰²\n\nã€å‡ºåŠ›ã€‘\nchunksé…åˆ—ï¼ˆå„ãƒãƒ£ãƒ³ã‚¯1000-1500ãƒˆãƒ¼ã‚¯ãƒ³ï¼‰\n- chunk_index: number\n- text: string\n- section: string\n- token_count: number\n\nã€ãƒ¢ãƒ‡ãƒ«ã€‘gpt-4o-mini\nã€ã‚³ã‚¹ãƒˆã€‘$0.003-0.006/å®Ÿè¡Œ"
    },

    {
      "parameters": {
        "method": "POST",
        "url": "https://api.openai.com/v1/embeddings",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "openAiApi",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ JSON.stringify({ input: $json.chunks.map(c => c.text), model: 'text-embedding-3-small' }) }}",
        "options": {
          "timeout": 60000
        }
      },
      "id": "e7f8a9b0-c1d2-3456-0123-567890123456",
      "name": "T017_Embeddingç”Ÿæˆ",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [3540, 200],
      "credentials": {
        "openAiApi": {
          "id": "2",
          "name": "OpenAI API Key"
        }
      },
      "onError": "stopWorkflow",
      "retryOnFail": true,
      "maxTries": 3,
      "waitBetweenTries": 10000,
      "notes": "ã€å®Ÿè¡Œå±¤ãƒ»ãƒ«ãƒ¼ãƒ—å†…ã€‘Embeddingãƒ™ã‚¯ãƒˆãƒ«ç”Ÿæˆ\n\nãƒ¢ãƒ‡ãƒ«: text-embedding-3-small\næ¬¡å…ƒæ•°: 1536\nå…¥åŠ›: ãƒãƒ£ãƒ³ã‚¯ãƒ†ã‚­ã‚¹ãƒˆé…åˆ—\nå‡ºåŠ›: embeddingsé…åˆ—\n\nã‚³ã‚¹ãƒˆ: $0.02/1M tokens"
    },

    {
      "parameters": {
        "operation": "executeQuery",
        "query": "=INSERT INTO papers (\n  title, authors, abstract, pdf_url, \n  arxiv_id, semantic_scholar_id, published_date, \n  drive_url, relevance_score, created_at\n)\nVALUES (\n  '{{ $json.metadata.title.replace(/'/g, \"''\") }}',\n  ARRAY[{{ $json.metadata.authors.map(a => `'${a.replace(/'/g, \"''\")}'`).join(',') }}],\n  '{{ $json.metadata.abstract?.replace(/'/g, \"''\") || \"\" }}',\n  '{{ $json.paper_info.pdf_url }}',\n  {{ $json.metadata.arxiv_id ? `'${$json.metadata.arxiv_id}'` : 'NULL' }},\n  {{ $json.metadata.semantic_scholar_id ? `'${$json.metadata.semantic_scholar_id}'` : 'NULL' }},\n  {{ $json.metadata.published_date ? `'${$json.metadata.published_date}'` : 'NULL' }},\n  '{{ $json.drive_url }}',\n  {{ $json.paper_info.relevance_score }},\n  NOW()\n)\nRETURNING id;",
        "options": {}
      },
      "id": "f8a9b0c1-d2e3-4567-1234-678901234567",
      "name": "T018_PostgreSQLä¿å­˜_ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿",
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.4,
      "position": [3760, 200],
      "credentials": {
        "postgres": {
          "id": "5",
          "name": "PostgreSQL Credentials"
        }
      },
      "onError": "stopWorkflow",
      "retryOnFail": true,
      "maxTries": 3,
      "waitBetweenTries": 5000,
      "notes": "ã€å®Ÿè¡Œå±¤ãƒ»ãƒ«ãƒ¼ãƒ—å†…ã€‘è«–æ–‡ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’DBä¿å­˜\n\nãƒ†ãƒ¼ãƒ–ãƒ«: papers\nãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰:\n- title, authors, abstract\n- pdf_url, arxiv_id, semantic_scholar_id\n- published_date, drive_url\n- relevance_score\n\nå‡ºåŠ›: paper_idï¼ˆRETURNING idï¼‰"
    },

    {
      "parameters": {
        "operation": "executeQuery",
        "query": "={% set paper_id = $('T018_PostgreSQLä¿å­˜_ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿').first().json.id %}\n{% set chunks = $json.chunks %}\n{% set embeddings = $('T017_Embeddingç”Ÿæˆ').first().json.data %}\n\nINSERT INTO paper_chunks (paper_id, chunk_index, chunk_text, section_name, embedding)\nVALUES\n{% for i in range(chunks.length) %}\n(\n  {{ paper_id }},\n  {{ i }},\n  '{{ chunks[i].text.replace(/'/g, \"''\") }}',\n  '{{ chunks[i].section }}',\n  '[{{ embeddings[i].embedding.join(',') }}]'\n){{ ',' if not loop.last else ';' }}\n{% endfor %}",
        "options": {}
      },
      "id": "a9b0c1d2-e3f4-5678-2345-789012345678",
      "name": "T019_pgvectorä¿å­˜",
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.4,
      "position": [3980, 200],
      "credentials": {
        "postgres": {
          "id": "5",
          "name": "PostgreSQL Credentials"
        }
      },
      "onError": "stopWorkflow",
      "retryOnFail": true,
      "maxTries": 3,
      "waitBetweenTries": 5000,
      "notes": "ã€å®Ÿè¡Œå±¤ãƒ»ãƒ«ãƒ¼ãƒ—å†…ã€‘ãƒãƒ£ãƒ³ã‚¯ï¼†ãƒ™ã‚¯ãƒˆãƒ«ã‚’DBä¿å­˜\n\nãƒ†ãƒ¼ãƒ–ãƒ«: paper_chunks\nãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰:\n- paper_idï¼ˆå¤–éƒ¨ã‚­ãƒ¼ï¼‰\n- chunk_index, chunk_text, section_name\n- embeddingï¼ˆvectorå‹ã€1536æ¬¡å…ƒï¼‰\n\npgvectoræ‹¡å¼µãŒå¿…è¦"
    },

    {
      "parameters": {
        "amount": 3,
        "unit": "seconds"
      },
      "id": "b0c1d2e3-f4a5-6789-3456-890123456789",
      "name": "T020_ãƒ¬ãƒ¼ãƒˆåˆ¶é™Wait_ãƒ«ãƒ¼ãƒ—",
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [4200, 200],
      "webhookBasedExecution": false,
      "notes": "ã€ãƒ«ãƒ¼ãƒ—å†…ã€‘æ¬¡ã®è«–æ–‡å‡¦ç†å‰ã®å¾…æ©Ÿ\n\nå¾…æ©Ÿæ™‚é–“: 3ç§’\nç†ç”±: APIä¿è­·ï¼ˆarXivæ¨å¥¨é–“éš”ï¼‰\n\nãƒ«ãƒ¼ãƒ—ãƒãƒƒã‚¯: T011ã¸æˆ»ã‚‹\nãƒ«ãƒ¼ãƒ—å®Œäº†: T021ã¸é€²ã‚€"
    },

    {
      "parameters": {
        "mode": "runOnceForAllItems",
        "jsCode": "// å‡¦ç†çµæœé›†ç´„ï¼ˆãƒ«ãƒ¼ãƒ—å®Œäº†å¾Œï¼‰\nconst allResults = $input.all();\nconst successful = [];\nconst failed = [];\nlet totalChunks = 0;\n\nfor (const item of allResults) {\n  if (item.json.metadata && item.json.chunks) {\n    // æˆåŠŸã‚±ãƒ¼ã‚¹\n    const paperId = $('T018_PostgreSQLä¿å­˜_ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿').all()\n      .find(n => n.json.metadata?.title === item.json.metadata.title)?.json.id;\n    \n    successful.push({\n      paper_id: paperId,\n      title: item.json.metadata.title,\n      drive_url: item.json.drive_url,\n      chunks_count: item.json.chunks.length\n    });\n    totalChunks += item.json.chunks.length;\n  } else if (item.json.error || item.json.title) {\n    // å¤±æ•—ã‚±ãƒ¼ã‚¹\n    failed.push({\n      title: item.json.title || item.json.paper_info?.title || 'Unknown',\n      error: item.json.error || 'PDFå–å¾—å¤±æ•—'\n    });\n  }\n}\n\nconst startTime = $workflow.startedAt || new Date();\nconst processingTime = Math.floor((new Date() - new Date(startTime)) / 1000);\n\nreturn [{\n  json: {\n    total_papers: allResults.length,\n    successful_papers: successful,\n    failed_papers: failed,\n    total_chunks: totalChunks,\n    processing_time_seconds: processingTime\n  }\n}];"
      },
      "id": "c1d2e3f4-a5b6-7890-4567-901234567890",
      "name": "T021_å‡¦ç†çµæœé›†ç´„",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [4420, 300],
      "notes": "ã€çµ±åˆå±¤ã€‘ãƒ«ãƒ¼ãƒ—å®Œäº†å¾Œã®çµæœé›†ç´„\n\nå‡ºåŠ›:\n- total_papers: å‡¦ç†ã—ãŸè«–æ–‡ç·æ•°\n- successful_papers: æˆåŠŸã—ãŸè«–æ–‡é…åˆ—\n- failed_papers: å¤±æ•—ã—ãŸè«–æ–‡é…åˆ—\n- total_chunks: ç·ãƒãƒ£ãƒ³ã‚¯æ•°\n- processing_time_seconds: å‡¦ç†æ™‚é–“"
    },

    {
      "parameters": {
        "mode": "runOnceForAllItems",
        "jsCode": "// ğŸ¤– AI: Discordã‚µãƒãƒªãƒ¼ç”Ÿæˆ\n// å½¹å‰²: å‡¦ç†çµæœã‚’ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼ãªMarkdownãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«å¤‰æ›\n\nconst summary = $json;\nconst originalQuestion = $('T003_è³ªå•ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ï¼†ã‚¯ã‚¨ãƒªæœ€é©åŒ–').first().json.original_question;\n\nconst systemPrompt = `ã‚ãªãŸã¯Discordãƒœãƒƒãƒˆã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ©ã‚¤ã‚¿ãƒ¼ã§ã™ã€‚æŠ€è¡“çš„ãªå‡¦ç†çµæœã‚’ã€èª­ã¿ã‚„ã™ãé­…åŠ›çš„ãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«å¤‰æ›ã—ã¾ã™ã€‚\n\nã€è²¬å‹™ã€‘\n1. å‡¦ç†çµæœã‚’ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼ã«è¦ç´„\n2. Markdownå½¢å¼ã§è¦–è¦šçš„ã«æ•´ç†\n3. è«–æ–‡ã‚¿ã‚¤ãƒˆãƒ«ã¨Google Drive URLã‚’ãƒªã‚¹ãƒˆåŒ–\n4. å‡¦ç†æ™‚é–“ã‚„çµ±è¨ˆæƒ…å ±ã‚’ç°¡æ½”ã«ä¼é”\n\nã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æ§‹æˆã€‘\n- ğŸ‰ å†’é ­ã®æŒ¨æ‹¶ã¨è¦ç´„\n- ğŸ“š è«–æ–‡ãƒªã‚¹ãƒˆ\n- ğŸ“Š çµ±è¨ˆæƒ…å ±\n- ğŸ’¡ æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ææ¡ˆ\n\nã€ãƒˆãƒ¼ãƒ³ã€‘ãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼ã§è¦ªã—ã¿ã‚„ã™ã„ã€çµµæ–‡å­—é©åº¦ä½¿ç”¨`;\n\nconst userPrompt = `ã€å…ƒã®è³ªå•ã€‘\"${originalQuestion}\"\n\nã€å‡¦ç†çµæœã€‘\nåˆè¨ˆ: ${summary.total_papers}ä»¶\næˆåŠŸ: ${summary.successful_papers.length}ä»¶\nå¤±æ•—: ${summary.failed_papers.length}ä»¶\nç·ãƒãƒ£ãƒ³ã‚¯: ${summary.total_chunks}å€‹\nå‡¦ç†æ™‚é–“: ${summary.processing_time_seconds}ç§’\n\næˆåŠŸè«–æ–‡:\n${summary.successful_papers.map((p, i) => `${i+1}. ${p.title}\\n   URL: ${p.drive_url}\\n   ãƒãƒ£ãƒ³ã‚¯: ${p.chunks_count}å€‹`).join('\\n')}\n\nã€ã‚¿ã‚¹ã‚¯ã€‘Discordã§èª­ã¿ã‚„ã™ã„Markdownãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«å¤‰æ›ã€‚\n\næœŸå¾…ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ:\nğŸ‰ **è«–æ–‡æ¤œç´¢å®Œäº†ï¼**\n\nã€Œ{è³ªå•è¦ç´„}ã€ã«é–¢é€£ã™ã‚‹è«–æ–‡ã‚’ **{æˆåŠŸæ•°}ä»¶** å–å¾—ã—ã¾ã—ãŸã€‚\n\nğŸ“š **å–å¾—ã—ãŸè«–æ–‡:**\n1. **{ã‚¿ã‚¤ãƒˆãƒ«}**\n   ğŸ“„ [Google Driveã§é–‹ã]({URL})\n   ğŸ“Š {ãƒãƒ£ãƒ³ã‚¯æ•°}å€‹ã®ãƒãƒ£ãƒ³ã‚¯ã«åˆ†å‰²æ¸ˆã¿\n\nğŸ“Š **å‡¦ç†çµ±è¨ˆ:**\n- ç·ãƒãƒ£ãƒ³ã‚¯æ•°: {total}å€‹\n- å‡¦ç†æ™‚é–“: {æ™‚é–“}ç§’\n\nğŸ’¡ **æ¬¡ã«ã§ãã‚‹ã“ã¨:**\nã“ã‚Œã‚‰ã®è«–æ–‡ã«ã¤ã„ã¦è³ªå•ã—ã¦ãã ã•ã„ï¼`;\n\nconst response = await fetch('https://api.openai.com/v1/chat/completions', {\n  method: 'POST',\n  headers: {\n    'Authorization': `Bearer ${$credentials.openAiApi.apiKey}`,\n    'Content-Type': 'application/json'\n  },\n  body: JSON.stringify({\n    model: 'gpt-4o-mini',\n    messages: [\n      { role: 'system', content: systemPrompt },\n      { role: 'user', content: userPrompt }\n    ],\n    temperature: 0.7,\n    max_tokens: 1500\n  })\n});\n\nif (!response.ok) {\n  // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯: ã‚·ãƒ³ãƒ—ãƒ«ãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸\n  const message = `ğŸ‰ è«–æ–‡æ¤œç´¢å®Œäº†ï¼\\n\\n${summary.successful_papers.length}ä»¶ã®è«–æ–‡ã‚’å–å¾—ã—ã¾ã—ãŸã€‚\\nå‡¦ç†æ™‚é–“: ${summary.processing_time_seconds}ç§’`;\n  return [{\n    json: {\n      message: message,\n      summary: summary,\n      channel_id: $('T002_è³ªå•å†…å®¹æŠ½å‡º').first().json.channel_id,\n      message_id: $('T002_è³ªå•å†…å®¹æŠ½å‡º').first().json.message_id\n    }\n  }];\n}\n\nconst data = await response.json();\nconst message = data.choices[0].message.content;\n\nreturn [{\n  json: {\n    message: message,\n    summary: summary,\n    channel_id: $('T002_è³ªå•å†…å®¹æŠ½å‡º').first().json.channel_id,\n    message_id: $('T002_è³ªå•å†…å®¹æŠ½å‡º').first().json.message_id\n  }\n}];"
      },
      "id": "d2e3f4a5-b6c7-8901-5678-012345678901",
      "name": "T022_Discordã‚µãƒãƒªãƒ¼ç”Ÿæˆ",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [4640, 300],
      "credentials": {
        "openAiApi": {
          "id": "2",
          "name": "OpenAI API Key"
        }
      },
      "onError": "continueRegularOutput",
      "retryOnFail": true,
      "maxTries": 2,
      "waitBetweenTries": 5000,
      "notes": "ğŸ¤– ã€AIã€‘Discordã‚µãƒãƒªãƒ¼ç”Ÿæˆ\n\nã€å½¹å‰²ã€‘\nå‡¦ç†çµæœã‚’èª­ã¿ã‚„ã™ã„Markdownãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«å¤‰æ›\n\nã€å‡ºåŠ›ã€‘\n- message: Markdownå½¢å¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸\n- summary: å‡¦ç†çµæœã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ\n- channel_id, message_id\n\nã€ãƒ¢ãƒ‡ãƒ«ã€‘gpt-4o-mini\nã€ã‚³ã‚¹ãƒˆã€‘$0.002-0.003/å®Ÿè¡Œ"
    },

    {
      "parameters": {
        "method": "POST",
        "url": "=https://discord.com/api/v10/channels/{{ $json.channel_id }}/messages",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ JSON.stringify({ content: $json.message, message_reference: { message_id: $json.message_id } }) }}",
        "options": {}
      },
      "id": "e3f4a5b6-c7d8-9012-6789-123456789012",
      "name": "T023_DiscordæˆåŠŸé€šçŸ¥",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [4860, 300],
      "credentials": {
        "httpHeaderAuth": {
          "id": "6",
          "name": "Discord Bot Token"
        }
      },
      "onError": "continueErrorOutput",
      "retryOnFail": true,
      "maxTries": 3,
      "waitBetweenTries": 5000,
      "notes": "ã€å‡ºåŠ›å±¤ã€‘å‡¦ç†å®Œäº†ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’Discordè¿”ä¿¡\n\nAPI: Discord REST API v10\nèªè¨¼: Bot Token (Authorization header)\nã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ: POST /channels/{channel_id}/messages\n\nãƒšã‚¤ãƒ­ãƒ¼ãƒ‰:\n- content: Markdownãƒ¡ãƒƒã‚»ãƒ¼ã‚¸\n- message_reference: å…ƒãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¸ã®è¿”ä¿¡"
    },

    {
      "parameters": {
        "operation": "executeQuery",
        "query": "=INSERT INTO execution_logs (\n  execution_id, question, paper_count, \n  successful_count, failed_count, \n  processing_time_seconds, status, created_at\n)\nVALUES (\n  '{{ $workflow.id }}',\n  '{{ $('T002_è³ªå•å†…å®¹æŠ½å‡º').first().json.question.replace(/'/g, \"''\") }}',\n  {{ $('T021_å‡¦ç†çµæœé›†ç´„').first().json.total_papers }},\n  {{ $('T021_å‡¦ç†çµæœé›†ç´„').first().json.successful_papers.length }},\n  {{ $('T021_å‡¦ç†çµæœé›†ç´„').first().json.failed_papers.length }},\n  {{ $('T021_å‡¦ç†çµæœé›†ç´„').first().json.processing_time_seconds }},\n  'success',\n  NOW()\n);",
        "options": {}
      },
      "id": "f4a5b6c7-d8e9-0123-7890-234567890123",
      "name": "T024_å‡¦ç†ãƒ­ã‚°è¨˜éŒ²",
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.4,
      "position": [5080, 300],
      "credentials": {
        "postgres": {
          "id": "5",
          "name": "PostgreSQL Credentials"
        }
      },
      "onError": "continueRegularOutput",
      "retryOnFail": true,
      "maxTries": 2,
      "waitBetweenTries": 3000,
      "notes": "ã€è¨˜éŒ²å±¤ã€‘å®Ÿè¡Œå±¥æ­´ã‚’logsãƒ†ãƒ¼ãƒ–ãƒ«ã«ä¿å­˜\n\nãƒ†ãƒ¼ãƒ–ãƒ«: execution_logs\nãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰:\n- execution_id, question\n- paper_count, successful_count, failed_count\n- processing_time_seconds, status\n\nç›£è¦–ãƒ»åˆ†æã«ä½¿ç”¨"
    },

    {
      "parameters": {
        "operation": "executeQuery",
        "query": "=INSERT INTO error_logs (\n  paper_title, pdf_url, error_message, created_at\n)\nVALUES (\n  '{{ $json.title?.replace(/'/g, \"''\") || \"Unknown\" }}',\n  '{{ $json.pdf_url || \"\" }}',\n  '{{ $json.error?.replace(/'/g, \"''\") || \"PDFå–å¾—å¤±æ•—\" }}',\n  NOW()\n);",
        "options": {}
      },
      "id": "a5b6c7d8-e9f0-1234-8901-345678901234",
      "name": "T025_PDFã‚¨ãƒ©ãƒ¼ãƒ­ã‚°è¨˜éŒ²",
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.4,
      "position": [2880, 400],
      "credentials": {
        "postgres": {
          "id": "5",
          "name": "PostgreSQL Credentials"
        }
      },
      "onError": "continueRegularOutput",
      "notes": "ã€è¨˜éŒ²å±¤ãƒ»ãƒ«ãƒ¼ãƒ—å†…å¤±æ•—ãƒ–ãƒ©ãƒ³ãƒã€‘PDFå–å¾—å¤±æ•—æ™‚ã®ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°\n\nãƒ†ãƒ¼ãƒ–ãƒ«: error_logs\nãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰:\n- paper_title, pdf_url\n- error_message\n\nT013ã®å¤±æ•—ãƒ–ãƒ©ãƒ³ãƒã‹ã‚‰å‘¼ã°ã‚Œã‚‹\nå‡¦ç†å¾ŒT020ã¸åˆæµ"
    },

    {
      "parameters": {
        "method": "POST",
        "url": "={{ $env.DISCORD_ADMIN_WEBHOOK_URL }}",
        "authentication": "none",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ JSON.stringify({\n  content: `ğŸš¨ **ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿ**\\n\\nãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼: ${$workflow.name}\\nå®Ÿè¡ŒID: ${$execution.id}\\nã‚¨ãƒ©ãƒ¼ãƒãƒ¼ãƒ‰: ${$json.node?.name || 'Unknown'}\\nã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸: ${$json.error?.message || 'Unknown error'}\\n\\nã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—: ${new Date().toISOString()}`\n}) }}",
        "options": {}
      },
      "id": "b6c7d8e9-f0a1-2345-9012-456789012345",
      "name": "T026_é‡å¤§ã‚¨ãƒ©ãƒ¼é€šçŸ¥",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [240, 600],
      "notes": "ã€Error Workflowã€‘é‡å¤§ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿæ™‚ã®ç®¡ç†è€…é€šçŸ¥\n\nç”¨é€”:\n- ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å…¨ä½“ã®è‡´å‘½çš„ã‚¨ãƒ©ãƒ¼\n- ãƒªãƒˆãƒ©ã‚¤å¤±æ•—å¾Œã®ã‚¨ãƒ©ãƒ¼\n- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šã‚¨ãƒ©ãƒ¼ç­‰\n\né€šçŸ¥å…ˆ: Discordç®¡ç†è€…Webhook\n\nè¨­å®šæ–¹æ³•:\nSettings â†’ Error Workflow â†’ åˆ¥é€”ä½œæˆã—ãŸError Workflowã‚’é¸æŠ"
    }
  ],

  "connections": {
    "T001_Discord_Webhookå—ä¿¡": {
      "main": [[{ "node": "T002_è³ªå•å†…å®¹æŠ½å‡º", "type": "main", "index": 0 }]]
    },
    "T002_è³ªå•å†…å®¹æŠ½å‡º": {
      "main": [[{ "node": "T003_è³ªå•ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ï¼†ã‚¯ã‚¨ãƒªæœ€é©åŒ–", "type": "main", "index": 0 }]]
    },
    "T003_è³ªå•ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ï¼†ã‚¯ã‚¨ãƒªæœ€é©åŒ–": {
      "main": [[{ "node": "T004_è«–æ–‡æ•°åˆ¤å®š", "type": "main", "index": 0 }]]
    },
    "T004_è«–æ–‡æ•°åˆ¤å®š": {
      "main": [
        [
          { "node": "T005_arXivè«–æ–‡æ¤œç´¢", "type": "main", "index": 0 },
          { "node": "T006_Semantic_Scholarè«–æ–‡æ¤œç´¢", "type": "main", "index": 0 }
        ],
        [
          { "node": "T005_arXivè«–æ–‡æ¤œç´¢", "type": "main", "index": 0 },
          { "node": "T006_Semantic_Scholarè«–æ–‡æ¤œç´¢", "type": "main", "index": 0 }
        ]
      ]
    },
    "T005_arXivè«–æ–‡æ¤œç´¢": {
      "main": [[{ "node": "T007_ãƒ¬ãƒ¼ãƒˆåˆ¶é™Wait", "type": "main", "index": 0 }]]
    },
    "T006_Semantic_Scholarè«–æ–‡æ¤œç´¢": {
      "main": [[{ "node": "T007_ãƒ¬ãƒ¼ãƒˆåˆ¶é™Wait", "type": "main", "index": 0 }]]
    },
    "T007_ãƒ¬ãƒ¼ãƒˆåˆ¶é™Wait": {
      "main": [[{ "node": "T008_è«–æ–‡ãƒ‡ãƒ¼ã‚¿çµ±åˆãƒ»æ­£è¦åŒ–", "type": "main", "index": 0 }]]
    },
    "T008_è«–æ–‡ãƒ‡ãƒ¼ã‚¿çµ±åˆãƒ»æ­£è¦åŒ–": {
      "main": [[{ "node": "T009_é‡è¤‡æ’é™¤ï¼†é–¢é€£åº¦ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°", "type": "main", "index": 0 }]]
    },
    "T009_é‡è¤‡æ’é™¤ï¼†é–¢é€£åº¦ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°": {
      "main": [[{ "node": "T010_è«–æ–‡ãƒ‡ãƒ¼ã‚¿ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³", "type": "main", "index": 0 }]]
    },
    "T010_è«–æ–‡ãƒ‡ãƒ¼ã‚¿ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³": {
      "main": [[{ "node": "T011_PDFãƒãƒƒãƒåˆ†å‰²", "type": "main", "index": 0 }]]
    },
    "T011_PDFãƒãƒƒãƒåˆ†å‰²": {
      "main": [[{ "node": "T012_PDFå–å¾—", "type": "main", "index": 0 }]]
    },
    "T012_PDFå–å¾—": {
      "main": [[{ "node": "T013_PDFå–å¾—å¯å¦åˆ¤å®š", "type": "main", "index": 0 }]]
    },
    "T013_PDFå–å¾—å¯å¦åˆ¤å®š": {
      "main": [
        [{ "node": "T014_Google_Driveä¿å­˜", "type": "main", "index": 0 }],
        [{ "node": "T025_PDFã‚¨ãƒ©ãƒ¼ãƒ­ã‚°è¨˜éŒ²", "type": "main", "index": 0 }]
      ]
    },
    "T014_Google_Driveä¿å­˜": {
      "main": [[{ "node": "T015_PDFâ†’ãƒ†ã‚­ã‚¹ãƒˆæŠ½å‡º", "type": "main", "index": 0 }]]
    },
    "T015_PDFâ†’ãƒ†ã‚­ã‚¹ãƒˆæŠ½å‡º": {
      "main": [[{ "node": "T016_ãƒ†ã‚­ã‚¹ãƒˆãƒãƒ£ãƒ³ã‚¯åˆ†å‰²", "type": "main", "index": 0 }]]
    },
    "T016_ãƒ†ã‚­ã‚¹ãƒˆãƒãƒ£ãƒ³ã‚¯åˆ†å‰²": {
      "main": [[{ "node": "T017_Embeddingç”Ÿæˆ", "type": "main", "index": 0 }]]
    },
    "T017_Embeddingç”Ÿæˆ": {
      "main": [[{ "node": "T018_PostgreSQLä¿å­˜_ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿", "type": "main", "index": 0 }]]
    },
    "T018_PostgreSQLä¿å­˜_ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿": {
      "main": [[{ "node": "T019_pgvectorä¿å­˜", "type": "main", "index": 0 }]]
    },
    "T019_pgvectorä¿å­˜": {
      "main": [[{ "node": "T020_ãƒ¬ãƒ¼ãƒˆåˆ¶é™Wait_ãƒ«ãƒ¼ãƒ—", "type": "main", "index": 0 }]]
    },
    "T020_ãƒ¬ãƒ¼ãƒˆåˆ¶é™Wait_ãƒ«ãƒ¼ãƒ—": {
      "main": [[{ "node": "T011_PDFãƒãƒƒãƒåˆ†å‰²", "type": "main", "index": 0 }]]
    },
    "T025_PDFã‚¨ãƒ©ãƒ¼ãƒ­ã‚°è¨˜éŒ²": {
      "main": [[{ "node": "T020_ãƒ¬ãƒ¼ãƒˆåˆ¶é™Wait_ãƒ«ãƒ¼ãƒ—", "type": "main", "index": 0 }]]
    },
    "T021_å‡¦ç†çµæœé›†ç´„": {
      "main": [[{ "node": "T022_Discordã‚µãƒãƒªãƒ¼ç”Ÿæˆ", "type": "main", "index": 0 }]]
    },
    "T022_Discordã‚µãƒãƒªãƒ¼ç”Ÿæˆ": {
      "main": [[{ "node": "T023_DiscordæˆåŠŸé€šçŸ¥", "type": "main", "index": 0 }]]
    },
    "T023_DiscordæˆåŠŸé€šçŸ¥": {
      "main": [[{ "node": "T024_å‡¦ç†ãƒ­ã‚°è¨˜éŒ²", "type": "main", "index": 0 }]]
    }
  },

  "settings": {
    "executionOrder": "v1",
    "saveManualExecutions": true,
    "saveExecutionProgress": true,
    "timezone": "Asia/Tokyo"
  },

  "staticData": null,
  "tags": ["Discord", "å­¦è¡“è«–æ–‡", "RAG", "AI", "è‡ªå‹•åŒ–"],
  "pinData": {},
  "versionId": "12345678-1234-1234-1234-123456789abc",

  "meta": {
    "instanceId": "your-n8n-instance-id"
  }
}