{
  "nodes": [
    {
      "parameters": {
        "batchSize": 3,
        "options": {
          "reset": false
        }
      },
      "id": "node_013_uuid",
      "name": "Split in Batches: 議題並列処理",
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [2550, 100],
      "notes": "議題を3個ずつのバッチに分割。⚠️ Output 0 (done) → node_016、Output 1 (loop) → node_014",
      "notesInFlow": true,
      "_comment": "【重要】Output 0=done（ループ完了後）、Output 1=loop（ループ内処理）"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "以下の議題から決定事項、宿題、保留事項を抽出してください：\n\n【議題】{{ $json.title }}\n【文字起こし】{{ $json.lines }}\n\n【出力形式】\nJSON：{\"agenda_id\": {{ $json.agenda_id }}, \"title\": \"{{ $json.title }}\", \"decisions\": [...], \"todos\": [...], \"pending\": [...]}",
        "options": {
          "systemMessage": "あなたは会議の分析専門家です。議題ごとに決定事項、宿題、保留事項を正確に抽出してください。"
        },
        "hasOutputParser": true
      },
      "id": "node_014_uuid",
      "name": "AI Agent: Step3 議題分析",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3,
      "position": [2775, 300],
      "notes": "各議題から決定事項、宿題、保留事項を抽出（並列実行3議題）",
      "notesInFlow": true,
      "onError": "continueErrorOutput",
      "retryOnFail": true,
      "maxTries": 1,
      "_comment": "【単一責務】決定事項・宿題・保留事項の抽出のみ"
    },
    {
      "parameters": {
        "mode": "loop"
      },
      "id": "node_015_uuid",
      "name": "Loop Back: バッチ処理継続",
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [3000, 300],
      "notes": "全バッチ処理が完了するまでループバック → node_013",
      "notesInFlow": true
    }
  ],
  "subnodes": [
    {
      "parameters": {
        "modelName": "models/gemini-2.0-flash-exp",
        "options": {
          "temperature": 0.4,
          "maxTokens": 4000,
          "topK": 40,
          "topP": 0.9
        }
      },
      "id": "subnode_014_01_uuid",
      "name": "Google Gemini Chat Model",
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [2775, -100],
      "credentials": {
        "googleGeminiOAuth2Api": {
          "id": "google_gemini_api_key_id",
          "name": "Google Gemini API"
        }
      }
    }
  ]
}
