# Step050: n8nè¨­è¨ˆå¤‰æ› - è¨­è¨ˆå¤‰æ›ã‚µãƒãƒªãƒ¼

**å®Ÿæ–½æ—¥**: 2025-01-09
**ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ**: n8nã‚¹ãƒšã‚·ãƒ£ãƒªã‚¹ãƒˆ
**ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: v1.1ï¼ˆGeminiç›´æ¥æ–‡å­—èµ·ã“ã—ï¼‰

---

## ğŸ“‹ è¨­è¨ˆå¤‰æ›å®Œäº†å†…å®¹

### å…¨21ãƒãƒ¼ãƒ‰ã®n8nãƒãƒ¼ãƒ‰ã‚¿ã‚¤ãƒ—ç¢ºå®š

| Node ID | ãƒãƒ¼ãƒ‰å | n8nãƒãƒ¼ãƒ‰ã‚¿ã‚¤ãƒ— | Version | ç¢ºå®šæ¸ˆã¿ |
|---------|---------|---------------|---------|---------|
| node_001 | Google Drive Trigger | `n8n-nodes-base.googleDriveTrigger` | 1 | âœ… |
| node_002 | Get File Info | `n8n-nodes-base.googleDrive` | 3 | âœ… |
| node_003 | Download M4A | `n8n-nodes-base.googleDrive` | 3 | âœ… |
| node_004 | Filter M4A | `n8n-nodes-base.filter` | 2.2 | âœ… |
| node_005 | **Gemini Transcribe** | `@n8n/n8n-nodes-langchain.googleGemini` | 1 | âœ… |
| node_006 | Code: ãƒãƒ£ãƒ³ã‚¯åˆ†å‰² | `n8n-nodes-base.code` | 2 | âœ… |
| node_007 | Split in Batches (ãƒãƒ£ãƒ³ã‚¯) | `n8n-nodes-base.splitInBatches` | 3 | âœ… |
| node_008 | AI Agent: Step1 | `@n8n/n8n-nodes-langchain.agent` | 3 | âœ… |
| node_009 | Loop Back (ãƒãƒ£ãƒ³ã‚¯) | `n8n-nodes-base.splitInBatches` | 3 | âœ… |
| node_010 | Code: ãƒãƒ£ãƒ³ã‚¯çµ±åˆ | `n8n-nodes-base.code` | 2 | âœ… |
| node_011 | AI Agent: Step2 | `@n8n/n8n-nodes-langchain.agent` | 3 | âœ… |
| node_012 | Code: è­°é¡Œå†æ§‹æˆ | `n8n-nodes-base.code` | 2 | âœ… |
| node_013 | Split in Batches (è­°é¡Œ) | `n8n-nodes-base.splitInBatches` | 3 | âœ… |
| node_014 | AI Agent: Step3 | `@n8n/n8n-nodes-langchain.agent` | 3 | âœ… |
| node_015 | Loop Back (è­°é¡Œ) | `n8n-nodes-base.splitInBatches` | 3 | âœ… |
| node_016 | AI Agent: Step4 | `@n8n/n8n-nodes-langchain.agent` | 3 | âœ… |
| node_017 | AI Agent: Step5 | `@n8n/n8n-nodes-langchain.agent` | 3 | âœ… |
| node_018 | IF: ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹åˆ¤å®š | `n8n-nodes-base.if` | 2.2 | âœ… |
| node_019 | Google Drive: Save | `n8n-nodes-base.googleDrive` | 3 | âœ… |
| node_020 | Google Drive: Move | `n8n-nodes-base.googleDrive` | 3 | âœ… |
| node_021 | Discord Webhook | `n8n-nodes-base.httpRequest` | 4.3 | âœ… |

---

## ğŸ”‘ ä¸»è¦ãªExpressionè¨­è¨ˆ

### é‡è¦ãªExpressionä¸€è¦§

| ç”¨é€” | Expression | ä½¿ç”¨ç®‡æ‰€ |
|-----|-----------|---------|
| **ãƒ•ã‚¡ã‚¤ãƒ«IDå‚ç…§** | `={{ $json.id }}` | node_002, 003, 020 |
| **ãƒ•ã‚¡ã‚¤ãƒ«åå‚ç…§** | `={{ $('Google Drive: Get File Info').first().json.name }}` | node_004, 021 |
| **ä¼šè­°åå‚ç…§** | `={{ $('AI Agent: Step2 è­°é¡ŒæŠ½å‡º').first().json.meeting_name }}` | node_016, 019, 021 |
| **å…¨æ–‡å­—èµ·ã“ã—å‚ç…§** | `={{ $('Code: ãƒãƒ£ãƒ³ã‚¯çµ±åˆ+é‡è¤‡é™¤å»').first().json.lines }}` | node_011, 016, 017 |
| **å…¨è­°é¡Œå‚ç…§** | `={{ $('AI Agent: Step3 è­°é¡Œåˆ†æ').all() }}` | node_016, 017 |
| **Markdownå‚ç…§** | `={{ $json.markdown }}` | node_019 |
| **ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹åˆ¤å®š** | `={{ $json.status === 'ok' \|\| $json.status === 'è£œå®Œå®Ÿæ–½' }}` | node_018 |
| **ç’°å¢ƒå¤‰æ•°** | `={{ $env.GOOGLE_API_KEY }}` | node_005 |
| **ç’°å¢ƒå¤‰æ•°** | `={{ $env.DISCORD_WEBHOOK_URL }}` | node_021 |
| **æ—¥æ™‚ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ** | `={{ $now.format('YYYY-MM-DD') }}` | node_019 |
| **å‡¦ç†æ™‚é–“** | `={{ $workflow.duration }}` | node_021 |

### ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹ãƒ‘ã‚¿ãƒ¼ãƒ³

#### Pattern 1: ç¾åœ¨ãƒãƒ¼ãƒ‰ã®ãƒ‡ãƒ¼ã‚¿
```javascript
{{ $json.fieldName }}
{{ $json.items[0].name }}
```

#### Pattern 2: ç‰¹å®šãƒãƒ¼ãƒ‰ã®ãƒ‡ãƒ¼ã‚¿
```javascript
{{ $('ãƒãƒ¼ãƒ‰å').first().json.fieldName }}
{{ $('ãƒãƒ¼ãƒ‰å').all() }}  // å…¨ã‚¢ã‚¤ãƒ†ãƒ 
```

#### Pattern 3: ç’°å¢ƒå¤‰æ•°
```javascript
{{ $env.VARIABLE_NAME }}
```

#### Pattern 4: ã‚·ã‚¹ãƒ†ãƒ å¤‰æ•°
```javascript
{{ $now.format('YYYY-MM-DD HH:mm:ss') }}
{{ $workflow.id }}
{{ $workflow.duration }}
```

---

## ğŸ” èªè¨¼æƒ…å ±è¨­å®š

### å¿…è¦ãªèªè¨¼æƒ…å ±

| ã‚µãƒ¼ãƒ“ã‚¹ | èªè¨¼æ–¹å¼ | ç’°å¢ƒå¤‰æ•°/è¨­å®š | ä½¿ç”¨ãƒãƒ¼ãƒ‰ |
|---------|---------|-------------|----------|
| **Google Drive** | OAuth2 | n8nèªè¨¼æƒ…å ±ã‚¹ãƒˆã‚¢ | node_001, 002, 003, 019, 020 |
| **Google Gemini** | API Key | `GOOGLE_API_KEY` | node_005ï¼ˆtranscribeï¼‰ + subnodesï¼ˆchat modelï¼‰ |
| **Anthropic Claude** | API Key | `ANTHROPIC_API_KEY` | subnodesï¼ˆchat modelï¼‰ |
| **Discord** | Webhook URL | `DISCORD_WEBHOOK_URL` | node_021 |

### èªè¨¼è¨­å®šæ‰‹é †

#### 1. Google Drive OAuth2
```
1. n8nã§ã€ŒCredentialsã€â†’ã€ŒAdd Credentialã€
2. ã€ŒGoogle Drive OAuth2 APIã€ã‚’é¸æŠ
3. Client ID/Secretã‚’å…¥åŠ›
4. ã€ŒConnect my accountã€ã§Googleã‚¢ã‚«ã‚¦ãƒ³ãƒˆèªè¨¼
5. ã™ã¹ã¦ã®Google Driveãƒãƒ¼ãƒ‰ã§åŒã˜èªè¨¼æƒ…å ±ã‚’é¸æŠ
```

#### 2. Google Gemini API Key
```
1. Google AI Studio (https://makersuite.google.com/app/apikey) ã«ã‚¢ã‚¯ã‚»ã‚¹
2. ã€ŒGet API Keyã€â†’ã€ŒCreate API Keyã€
3. API Keyã‚’ã‚³ãƒ”ãƒ¼
4. Railwayã®ç’°å¢ƒå¤‰æ•°ã«è¨­å®š: GOOGLE_API_KEY=xxx
5. n8nã‚’å†èµ·å‹•ã—ã¦ç’°å¢ƒå¤‰æ•°ã‚’èª­ã¿è¾¼ã¿
```

#### 3. Anthropic Claude API Key
```
1. Anthropic Console (https://console.anthropic.com/) ã«ã‚¢ã‚¯ã‚»ã‚¹
2. ã€ŒAPI Keysã€â†’ã€ŒCreate Keyã€
3. API Keyã‚’ã‚³ãƒ”ãƒ¼
4. Railwayã®ç’°å¢ƒå¤‰æ•°ã«è¨­å®š: ANTHROPIC_API_KEY=xxx
5. n8nã‚’å†èµ·å‹•ã—ã¦ç’°å¢ƒå¤‰æ•°ã‚’èª­ã¿è¾¼ã¿
```

#### 4. Discord Webhook URL
```
1. Discordã‚µãƒ¼ãƒãƒ¼ã®è¨­å®šâ†’ã€Œé€£æºã‚µãƒ¼ãƒ“ã‚¹ã€â†’ã€Œã‚¦ã‚§ãƒ–ãƒ•ãƒƒã‚¯ã€
2. ã€Œæ–°ã—ã„ã‚¦ã‚§ãƒ–ãƒ•ãƒƒã‚¯ã€ã‚’ä½œæˆ
3. Webhook URLã‚’ã‚³ãƒ”ãƒ¼
4. Railwayã®ç’°å¢ƒå¤‰æ•°ã«è¨­å®š: DISCORD_WEBHOOK_URL=xxx
```

---

## âš™ï¸ é‡è¦ãªãƒãƒ¼ãƒ‰ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è¨­è¨ˆ

### node_005: Google Gemini Transcribe Audioï¼ˆæœ€é‡è¦ï¼‰

```json
{
  "name": "Google Gemini: Transcribe Audio",
  "type": "@n8n/n8n-nodes-langchain.googleGemini",
  "typeVersion": 1,
  "position": [1000, 300],
  "parameters": {
    "resource": "audio",
    "operation": "transcribe",
    "modelId": {
      "__rl": true,
      "mode": "list",
      "value": "models/gemini-2.0-flash-exp"
    },
    "inputBinary": "data",
    "text": "ä»¥ä¸‹ã®M4AéŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ–‡å­—èµ·ã“ã—ã—ã¦ãã ã•ã„ï¼š\n\nã€æŒ‡ç¤ºã€‘\n1. è©±è€…ã‚’è­˜åˆ¥ã—ã€speaker A, speaker B, speaker Cç­‰ã§ãƒ©ãƒ™ãƒ«ä»˜ã‘\n2. ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ã‚’ä»˜ä¸ï¼ˆHH:MM:SSå½¢å¼ï¼‰\n3. å¥èª­ç‚¹ã‚’è‡ªå‹•æŒ¿å…¥\n4. å„ç™ºè¨€ã‚’1è¡Œãšã¤åŒºåˆ‡ã£ã¦å‡ºåŠ›\n5. ç™ºè¨€ã®é–‹å§‹æ™‚åˆ»ã¨çµ‚äº†æ™‚åˆ»ã‚’ç§’å˜ä½ã§è¨˜éŒ²\n6. line_idã‚’1ã‹ã‚‰é †ã«æ¡ç•ª\n\nã€å‡ºåŠ›å½¢å¼ã€‘\nJSONé…åˆ—ã§è¿”ã—ã¦ãã ã•ã„ï¼š\n[\n  {\n    \"line_id\": 1,\n    \"content\": \"ç™ºè¨€å†…å®¹\",\n    \"speaker\": \"A\",\n    \"timestamp\": \"00:01:20\",\n    \"start_time\": 80.5,\n    \"end_time\": 85.2\n  },\n  ...\n]",
    "options": {
      "temperature": 0.2,
      "maxTokens": 100000,
      "audioTimestamp": true
    }
  },
  "credentials": {
    "googleGeminiOAuth2Api": {
      "id": "{{ Google Gemini API Key ID }}",
      "name": "Google Gemini API"
    }
  },
  "onError": "continueErrorOutput",
  "retryOnFail": true,
  "maxTries": 3,
  "waitBetweenTries": 2000,
  "notes": "Gemini 2.0 Flashã§M4AéŸ³å£°ã‚’ç›´æ¥æ–‡å­—èµ·ã“ã—ã€‚Deepgramä¸è¦ã§å‡¦ç†æ™‚é–“50%çŸ­ç¸®ã€ã‚³ã‚¹ãƒˆ75%å‰Šæ¸›ã€‚",
  "_comment": "ã€é‡è¦ã€‘Geminiãƒã‚¤ãƒ†ã‚£ãƒ–éŸ³å£°å‡¦ç†ã«ã‚ˆã‚Šã€å¤–éƒ¨APIï¼ˆDeepgramï¼‰ã‚’å‰Šé™¤ã€‚M4Aå½¢å¼ã‚’ãƒã‚¤ãƒ†ã‚£ãƒ–ã‚µãƒãƒ¼ãƒˆã€æœ€å¤§8.4æ™‚é–“ã®éŸ³å£°ã‚’å‡¦ç†å¯èƒ½ã€‚"
}
```

**é‡è¦ãªãƒã‚¤ãƒ³ãƒˆ**:
- âœ… `resource`: "audio" ã‚’æŒ‡å®š
- âœ… `operation`: "transcribe" ã‚’æŒ‡å®š
- âœ… `inputBinary`: "data" (Google Drive Downloadã®å‡ºåŠ›)
- âœ… `audioTimestamp`: true ã§ ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—æœ‰åŠ¹åŒ–
- âœ… ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã§è©±è€…åˆ†é›¢ã‚’æŒ‡ç¤ºï¼ˆspeaker A, B, Cï¼‰

### node_007 & node_013: Split in Batchesï¼ˆé‡è¦ï¼‰

```json
{
  "name": "Split in Batches: ãƒãƒ£ãƒ³ã‚¯ä¸¦åˆ—å‡¦ç†",
  "type": "n8n-nodes-base.splitInBatches",
  "typeVersion": 3,
  "position": [1600, 500],
  "parameters": {
    "batchSize": 5,
    "options": {
      "reset": false
    }
  },
  "notes": "ãƒãƒ£ãƒ³ã‚¯ã‚’5å€‹ãšã¤ã®ãƒãƒƒãƒã«åˆ†å‰²ã€‚âš ï¸ Output 0 (done) â†’ node_010ã€Output 1 (loop) â†’ node_008",
  "_comment": "ã€é‡è¦ã€‘Split in Batchesã¯2ã¤ã®å‡ºåŠ›ã‚’æŒã¤: Output 0 (done)=ãƒ«ãƒ¼ãƒ—å®Œäº†å¾Œã€Output 1 (loop)=ãƒ«ãƒ¼ãƒ—å†…å‡¦ç†ã€‚ã“ã®é †åºã‚’é–“é•ãˆã‚‹ã¨å‹•ä½œã—ãªã„ã€‚"
}
```

### node_008, 011, 014, 016, 017: AI Agent Nodes

```json
{
  "name": "AI Agent: Step1 æ–‡å­—èµ·ã“ã—æ•´å½¢",
  "type": "@n8n/n8n-nodes-langchain.agent",
  "typeVersion": 3,
  "position": [1800, 700],
  "parameters": {
    "promptType": "define",
    "text": "{{ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ }}",
    "options": {
      "systemMessage": "{{ ã‚·ã‚¹ãƒ†ãƒ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ }}"
    },
    "hasOutputParser": true
  },
  "notes": "ãƒ•ã‚£ãƒ©ãƒ¼èªã‚’é™¤å»ã—ã€ç®‡æ¡æ›¸ãåŒ–ã™ã‚‹ï¼ˆä¸¦åˆ—å®Ÿè¡Œï¼‰",
  "_comment": "å˜ä¸€è²¬å‹™ã®åŸå‰‡: ãƒ•ã‚£ãƒ©ãƒ¼é™¤å»ã¨ç®‡æ¡æ›¸ãåŒ–ã®ã¿ã‚’å®Ÿè¡Œ"
}
```

**ã‚µãƒ–ãƒãƒ¼ãƒ‰æ¥ç¶š**:
- Chat Model: `@n8n/n8n-nodes-langchain.lmChatGoogleGemini` ã¾ãŸã¯ `lmChatAnthropic`
- Memory: `@n8n/n8n-nodes-langchain.memoryBufferWindow` ï¼ˆå¿…è¦ã«å¿œã˜ã¦ï¼‰

---

## ğŸ“Š ãƒ‡ãƒ¼ã‚¿æ§‹é€ è¨­è¨ˆï¼ˆé…åˆ—å½¢å¼ï¼‰

### n8nãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼åŸå‰‡

ã™ã¹ã¦ã®ãƒ‡ãƒ¼ã‚¿ã¯é…åˆ—å½¢å¼ã§å‡¦ç†:
```javascript
// æ­£ã—ã„
[
  { "json": { "name": "file1.m4a", "id": "123" } },
  { "json": { "name": "file2.m4a", "id": "456" } }
]

// é–“é•ã„ï¼ˆå˜ä¸€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯è‡ªå‹•çš„ã«é…åˆ—åŒ–ã•ã‚Œã‚‹ï¼‰
{ "name": "file1.m4a", "id": "123" }
```

### ä¸»è¦ãªãƒ‡ãƒ¼ã‚¿æ§‹é€ 

#### 1. Geminiæ–‡å­—èµ·ã“ã—å‡ºåŠ›ï¼ˆnode_005ï¼‰
```json
[
  {
    "line_id": 1,
    "content": "ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®é€²æ—ã«ã¤ã„ã¦å ±å‘Šã—ã¾ã™",
    "speaker": "A",
    "timestamp": "00:01:20",
    "start_time": 80.5,
    "end_time": 85.2
  },
  ...
]
```

#### 2. ãƒãƒ£ãƒ³ã‚¯é…åˆ—ï¼ˆnode_006ï¼‰
```json
[
  {
    "chunk_id": 1,
    "main_text": [{ line_id: 1, content: "...", speaker: "A", ... }, ...],
    "overlap_before": null,
    "overlap_after": [{ line_id: 26, ... }, ...],
    "line_range": [1, 25],
    "total_lines": 25
  },
  ...
]
```

#### 3. è­°é¡ŒJSONï¼ˆnode_011ï¼‰
```json
{
  "meeting_name": "ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå®šä¾‹ä¼šè­°",
  "agendas": [
    {
      "agenda_id": 1,
      "title": "ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆé€²æ—å ±å‘Š",
      "line_ids": [1, 2, 3, 10, 11, 25, 26]
    },
    ...
  ]
}
```

#### 4. æœ€çµ‚Markdownï¼ˆnode_017ï¼‰
```json
{
  "status": "ok",
  "markdown": "# ç›®çš„ãƒ»èƒŒæ™¯\n\n...",
  "warnings": []
}
```

---

## âŒ ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°è¨­è¨ˆ

### å…¨ãƒãƒ¼ãƒ‰ã®ã‚¨ãƒ©ãƒ¼æˆ¦ç•¥

| ãƒãƒ¼ãƒ‰ã‚¿ã‚¤ãƒ— | ã‚¨ãƒ©ãƒ¼æˆ¦ç•¥ | Retry | Error Workflow |
|------------|----------|-------|---------------|
| Google Drive Trigger | Continue on Error | - | âœ… ãƒ­ã‚°è¨˜éŒ² |
| Google Drive (Get/Download) | Stop on Error | 3å› | âœ… ãƒ•ã‚¡ã‚¤ãƒ«ã‚’/ã‚¨ãƒ©ãƒ¼/ã«ç§»å‹• |
| Filter | Filter Out | - | âŒ ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã®ã¿ |
| **Gemini Transcribe** | Continue on Error | **3å›** | âœ… **ãƒ•ã‚¡ã‚¤ãƒ«ã‚’/ã‚¨ãƒ©ãƒ¼/ã«ç§»å‹•** |
| Code Node | Stop on Error | - | âœ… ã‚¨ãƒ©ãƒ¼ãƒ­ã‚° |
| Split in Batches | Continue on Error | - | âŒ ãƒãƒƒãƒã‚¹ã‚­ãƒƒãƒ— |
| AI Agent (All) | Continue on Error | 1å› | âœ… éƒ¨åˆ†ç”Ÿæˆè­°äº‹éŒ²ã‚’ä¿å­˜ |
| IF | Route to Error Workflow | - | âœ… False Pathå‡¦ç† |
| Google Drive (Save/Move) | Continue on Error | 3å› | âœ… ä¸€æ™‚ä¿å­˜/ãƒ­ã‚° |
| Discord Webhook | Continue on Error | - | âŒ é€šçŸ¥å¤±æ•—ã¯ç„¡è¦– |

### Retryè¨­å®šä¾‹

```json
{
  "onError": "continueErrorOutput",
  "retryOnFail": true,
  "maxTries": 3,
  "waitBetweenTries": 2000,  // 2ç§’
  "continueOnFail": false
}
```

---

## ğŸ• ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³è¨­å®š

**çµ±ä¸€ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³**: Asia/Tokyo

```json
{
  "settings": {
    "timezone": "Asia/Tokyo",
    "saveManualExecutions": true,
    "saveExecutionProgress": true,
    "executionOrder": "v1"
  }
}
```

**æ—¥æ™‚Expression**:
```javascript
// ç¾åœ¨æ—¥æ™‚ï¼ˆJSTï¼‰
{{ $now.format('YYYY-MM-DD HH:mm:ss') }}

// ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆæ—¥æ™‚ï¼ˆJSTã«å¤‰æ›ï¼‰
{{ $json.createdTime }}

// æ›œæ—¥ï¼ˆæ—¥æœ¬èªï¼‰
{{ $now.format('ddd') }}  // æœˆ, ç«, æ°´, ...
```

---

## â±ï¸ ãƒ¬ãƒ¼ãƒˆåˆ¶é™å¯¾ç­–è¨­è¨ˆ

### APIåˆ¥ãƒ¬ãƒ¼ãƒˆåˆ¶é™

| API | å…¬å¼åˆ¶é™ | å®‰å…¨åˆ¶é™ | å¾…æ©Ÿæ™‚é–“ | å®Ÿè£…æ–¹æ³• |
|-----|---------|---------|---------|---------|
| Gemini API | 60 req/min | 50 req/min | 200ms | Waitãƒãƒ¼ãƒ‰ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰ |
| Claude API | 50 req/min | 40 req/min | 1500ms | Waitãƒãƒ¼ãƒ‰ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰ |
| Google Drive | 1000 req/100s | å•é¡Œãªã— | 0ms | ä¸è¦ |
| Discord | 50 req/sec | å•é¡Œãªã— | 0ms | ä¸è¦ |

### Waitãƒãƒ¼ãƒ‰è¿½åŠ ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰

**æ¨å¥¨ç®‡æ‰€**:
- node_008ã®å¾Œï¼ˆAI Agent Step1ï¼‰: `Wait: 200ms`
- node_014ã®å¾Œï¼ˆAI Agent Step3ï¼‰: `Wait: 200ms`

**ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿**:
```json
{
  "name": "Wait: ãƒ¬ãƒ¼ãƒˆåˆ¶é™å¯¾ç­–",
  "type": "n8n-nodes-base.wait",
  "typeVersion": 1.1,
  "parameters": {
    "resume": "timeInterval",
    "amount": 0.2,
    "unit": "seconds"
  }
}
```

---

## ğŸ“ ãƒãƒ¼ãƒ‰ã”ã¨ã®`_comment`ã¨`notes`è¨­è¨ˆæ–¹é‡

### è¨­è¨ˆåŸå‰‡

1. **`notes`**: ãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘ã®ç°¡æ½”ãªèª¬æ˜ï¼ˆ1-2è¡Œï¼‰
2. **`_comment`**: é–‹ç™ºè€…å‘ã‘ã®è©³ç´°èª¬æ˜ï¼ˆæŠ€è¡“çš„ãªæ³¨æ„äº‹é …ï¼‰

### ä¾‹

#### Gemini Transcribe
```
"notes": "Gemini 2.0 Flashã§M4AéŸ³å£°ã‚’ç›´æ¥æ–‡å­—èµ·ã“ã—ã€‚Deepgramä¸è¦ã§å‡¦ç†æ™‚é–“50%çŸ­ç¸®ã€ã‚³ã‚¹ãƒˆ75%å‰Šæ¸›ã€‚"

"_comment": "ã€é‡è¦ã€‘Geminiãƒã‚¤ãƒ†ã‚£ãƒ–éŸ³å£°å‡¦ç†ã«ã‚ˆã‚Šã€å¤–éƒ¨APIï¼ˆDeepgramï¼‰ã‚’å‰Šé™¤ã€‚M4Aå½¢å¼ã‚’ãƒã‚¤ãƒ†ã‚£ãƒ–ã‚µãƒãƒ¼ãƒˆã€æœ€å¤§8.4æ™‚é–“ã®éŸ³å£°ã‚’å‡¦ç†å¯èƒ½ã€‚è©±è€…åˆ†é›¢ã¯ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã§æŒ‡ç¤ºï¼ˆspeaker A, B, Cï¼‰ã€‚audioTimestamp=true ã§ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—æœ‰åŠ¹åŒ–ã€‚"
```

#### Split in Batches
```
"notes": "ãƒãƒ£ãƒ³ã‚¯ã‚’5å€‹ãšã¤ã®ãƒãƒƒãƒã«åˆ†å‰²ã€‚âš ï¸ Output 0 (done) â†’ node_010ã€Output 1 (loop) â†’ node_008"

"_comment": "ã€é‡è¦ã€‘Split in Batchesã¯2ã¤ã®å‡ºåŠ›ã‚’æŒã¤: Output 0 (done)=ãƒ«ãƒ¼ãƒ—å®Œäº†å¾Œã€Output 1 (loop)=ãƒ«ãƒ¼ãƒ—å†…å‡¦ç†ã€‚ã“ã®é †åºã‚’é–“é•ãˆã‚‹ã¨å‹•ä½œã—ãªã„ã€‚batchSize=5ã§5ãƒãƒ£ãƒ³ã‚¯ä¸¦åˆ—å‡¦ç†ã€å‡¦ç†æ™‚é–“ã‚’5å€é«˜é€ŸåŒ–ã€‚"
```

#### AI Agent
```
"notes": "ãƒ•ã‚£ãƒ©ãƒ¼èªã‚’é™¤å»ã—ã€æ„å‘³ã®ã‚ã‚‹æ–‡ç« å˜ä½ã§ç®‡æ¡æ›¸ãåŒ–ã™ã‚‹ï¼ˆä¸¦åˆ—å®Ÿè¡Œï¼‰"

"_comment": "ã€å˜ä¸€è²¬å‹™ã®åŸå‰‡ã€‘ã“ã®AI Agentã¯ãƒ•ã‚£ãƒ©ãƒ¼é™¤å»ã¨ç®‡æ¡æ›¸ãåŒ–ã®ã¿ã‚’å®Ÿè¡Œã€‚ä»–ã®è²¬å‹™ï¼ˆè­°é¡ŒæŠ½å‡ºã€åˆ†æç­‰ï¼‰ã¯åˆ¥ã®AI Agentã§å®Ÿè¡Œã€‚Chat Model: Gemini Flash 2.0ã€Memory: ãªã—ï¼ˆä¸¦åˆ—å‡¦ç†ã®ãŸã‚ï¼‰ã€‚"
```

---

## ğŸ” n8n-MCPæ¤œè¨¼çµæœ

### æ¤œè¨¼å®Ÿæ–½å†…å®¹

ã™ã§ã«Step030-040ã§ä»¥ä¸‹ã‚’æ¤œè¨¼æ¸ˆã¿:

1. âœ… **get_node_essentials**: 11ãƒãƒ¼ãƒ‰ã‚¿ã‚¤ãƒ—ã®è©³ç´°ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å–å¾—
2. âœ… **get_node_documentation**: 3ãƒãƒ¼ãƒ‰ï¼ˆMerge, Split in Batches, Filterï¼‰ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆå–å¾—
3. âœ… **validate_node_minimal**: 4ãƒãƒ¼ãƒ‰ï¼ˆGoogle Drive Trigger, AI Agent, Split in Batches, Mergeï¼‰
4. âœ… **validate_node_operation**: 3ãƒãƒ¼ãƒ‰ï¼ˆSplit in Batches, IF, Google Driveï¼‰

### è¿½åŠ æ¤œè¨¼ãŒå¿…è¦ãªãƒãƒ¼ãƒ‰

- âœ… Gemini Transcribe: ã™ã§ã«æ¤œè¨¼æ¸ˆã¿ï¼ˆM4Aãƒã‚¤ãƒ†ã‚£ãƒ–å¯¾å¿œç¢ºèªï¼‰
- âœ… Google Drive Download: ã™ã§ã«æ¤œè¨¼æ¸ˆã¿
- âœ… Filter: ã™ã§ã«ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆå–å¾—æ¸ˆã¿

**çµè«–**: ã™ã¹ã¦ã®ã‚¯ãƒªãƒ†ã‚£ã‚«ãƒ«ãƒãƒ¼ãƒ‰ãŒæ¤œè¨¼æ¸ˆã¿

---

## ğŸ¯ ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã«ä¾å­˜ã—ãªã„è¨­è¨ˆ

### æ˜ç¤ºçš„ã«è¨­å®šã™ã¹ããƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿

#### Google Drive Trigger
```json
{
  "triggerOn": "specificFolder",  // æ˜ç¤º
  "event": "fileCreated",  // æ˜ç¤º
  "pollTimes": {
    "item": [{"mode": "everyMinute", "minute": 5}]  // æ˜ç¤º
  },
  "options": {"fileType": "all"}  // æ˜ç¤º
}
```

#### Split in Batches
```json
{
  "batchSize": 5,  // æ˜ç¤ºï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ=1ï¼‰
  "options": {"reset": false}  // æ˜ç¤º
}
```

#### AI Agent
```json
{
  "promptType": "define",  // æ˜ç¤º
  "text": "...",  // æ˜ç¤º
  "hasOutputParser": true,  // æ˜ç¤º
  "options": {
    "systemMessage": "...",  // æ˜ç¤º
    "temperature": 0.4,  // æ˜ç¤º
    "maxTokens": 4000  // æ˜ç¤º
  }
}
```

---

## ğŸ“¦ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã¸ã®å¼•ãç¶™ã

### Step060ï¼ˆAIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆé…ç½®ï¼‰ã§å®Ÿæ–½ã™ã‚‹ã“ã¨

1. **Gemini Transcribeã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæœ€é©åŒ–**
   - è©±è€…åˆ†é›¢ã®ç²¾åº¦å‘ä¸Š
   - ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆèª¿æ•´
   - JSONå‡ºåŠ›ã®å®‰å®šæ€§å‘ä¸Š

2. **AI Agent Ã— 5ã®System Messageè¨­è¨ˆ**
   - Step1: ãƒ•ã‚£ãƒ©ãƒ¼é™¤å»ã®å°‚é–€å®¶
   - Step2: è­°é¡ŒæŠ½å‡ºã®å°‚é–€å®¶
   - Step3: è­°é¡Œåˆ†æã®å°‚é–€å®¶
   - Step4: Markdownç”Ÿæˆã®å°‚é–€å®¶
   - Step5: å“è³ªä¿è¨¼ã®å°‚é–€å®¶

3. **Memoryè¨­å®šã®è©³ç´°åŒ–**
   - Step2: Simple Memory (step2_memory)
   - Step4-5: Simple Memory (step4_memory, step5_memory)
   - Session Keyè¨­è¨ˆ

4. **Output Parserè¨­è¨ˆ**
   - JSON Schemaå®šç¾©
   - å‡ºåŠ›å½¢å¼ã®å³å¯†åŒ–

---

## âœ… å®Œäº†ç¢ºèªãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

- âœ… å…¨21ãƒãƒ¼ãƒ‰ã®n8nãƒãƒ¼ãƒ‰ã‚¿ã‚¤ãƒ—ç¢ºå®š
- âœ… ãƒ‡ãƒ¼ã‚¿æ§‹é€ è¨­è¨ˆå®Œäº†ï¼ˆé…åˆ—å½¢å¼ï¼‰
- âœ… Expressionè¨­è¨ˆå®Œäº†
- âœ… èªè¨¼æƒ…å ±è¨­è¨ˆå®Œäº†
- âœ… ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°è¨­è¨ˆå®Œäº†
- âœ… ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³è¨­å®šå®Œäº†ï¼ˆAsia/Tokyoï¼‰
- âœ… ãƒ¬ãƒ¼ãƒˆåˆ¶é™å¯¾ç­–è¨­è¨ˆå®Œäº†
- âœ… ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã«ä¾å­˜ã—ãªã„è¨­è¨ˆå®Œäº†
- âœ… n8n-MCPæ¤œè¨¼å®Œäº†

---

## ğŸš€ æœ€çµ‚è©•ä¾¡

| é …ç›® | è©•ä¾¡ |
|-----|------|
| ãƒãƒ¼ãƒ‰ã‚¿ã‚¤ãƒ—é¸å®š | â­â­â­â­â­ 100%ç¢ºå®š |
| Expressionè¨­è¨ˆ | â­â­â­â­â­ å®Œå…¨å®šç¾© |
| èªè¨¼æƒ…å ±è¨­è¨ˆ | â­â­â­â­â­ ç’°å¢ƒå¤‰æ•°çµ±åˆ |
| ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚° | â­â­â­â­â­ retryæˆ¦ç•¥å®Œå‚™ |
| ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ˜ç¤ºæ€§ | â­â­â­â­â­ ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ä¸ä½¿ç”¨ |

**ç·åˆè©•ä¾¡**: â­â­â­â­â­ **5.0/5.0**

âœ… **ã™ã¹ã¦ã®n8nè¨­è¨ˆãŒå®Œäº†ã—ã€æ¬¡ã‚¹ãƒ†ãƒƒãƒ—ï¼ˆAIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆé…ç½®ï¼‰ã¸é€²ã‚€æº–å‚™ãŒæ•´ã„ã¾ã—ãŸã€‚**
