{
  "name": "Group 2: éŸ³å£°æ–‡å­—èµ·ã“ã—ãƒ»ãƒãƒ£ãƒ³ã‚¯åˆ†å‰²",
  "nodes": [
    {
      "id": "http_whisper_g2_01",
      "type": "n8n-nodes-base.httpRequest",
      "name": "Fireworks Whisper v3æ–‡å­—èµ·ã“ã—",
      "typeVersion": 4,
      "position": [1400, 300],
      "parameters": {
        "method": "POST",
        "url": "https://api.fireworks.ai/v1/audio/transcriptions",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "fireworksApi",
        "sendBody": true,
        "bodyContentType": "multipart-form-data",
        "bodyParameters": {
          "parameters": [
            {
              "name": "file",
              "inputDataFieldName": "data",
              "parameterType": "formBinaryData"
            },
            {
              "name": "model",
              "value": "whisper-v3-large"
            },
            {
              "name": "language",
              "value": "ja"
            },
            {
              "name": "diarization",
              "value": "true"
            },
            {
              "name": "response_format",
              "value": "verbose_json"
            }
          ]
        },
        "options": {
          "timeout": 300000
        }
      },
      "credentials": {
        "fireworksApi": {
          "id": "fireworks_api",
          "name": "Fireworks AI API"
        }
      },
      "_comment": "Fireworks AI Whisper v3-largeã‚’ä½¿ç”¨ã—ã¦ã€M4AéŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆæœ€å¤§1GBï¼‰ã‚’æ—¥æœ¬èªæ–‡å­—èµ·ã“ã—ã—ã¾ã™ã€‚1æ™‚é–“ã®éŸ³å£°ã‚’ç´„4ç§’ã§å‡¦ç†ï¼ˆDeepgramæ¯”95%é«˜é€ŸåŒ–ï¼‰ã€ã‚³ã‚¹ãƒˆ99%å‰Šæ¸›ã‚’å®Ÿç¾ã€‚diarization=trueã§è©±è€…è­˜åˆ¥ã‚’æœ‰åŠ¹åŒ–ã—ã€response_format=verbose_jsonã§è©³ç´°ãªã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ã¨ã‚»ã‚°ãƒ¡ãƒ³ãƒˆæƒ…å ±ã‚’å–å¾—ã—ã¾ã™ã€‚",
      "notes": "method: POST | url: Fireworks API | authentication: fireworksApi | bodyContentType: multipart-form-data | model: whisper-v3-large | language: ja | diarization: true | response_format: verbose_json | timeout: 5åˆ† | ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹: 1æ™‚é–“éŸ³å£°â†’4ç§’å‡¦ç†"
    },
    {
      "id": "set_meta_g2_02",
      "type": "n8n-nodes-base.set",
      "name": "æ–‡å­—èµ·ã“ã—ãƒ¡ã‚¿æ•´å½¢",
      "typeVersion": 3,
      "position": [1600, 300],
      "parameters": {
        "mode": "manual",
        "duplicateItem": false,
        "assignments": {
          "assignments": [
            {
              "id": "meta_transcript",
              "name": "transcript",
              "type": "string",
              "value": "={{ $json.text }}"
            },
            {
              "id": "meta_duration",
              "name": "duration_seconds",
              "type": "number",
              "value": "={{ $json.duration }}"
            },
            {
              "id": "meta_segments",
              "name": "segments",
              "type": "object",
              "value": "={{ $json.segments }}"
            },
            {
              "id": "meta_lines",
              "name": "total_lines",
              "type": "number",
              "value": "={{ $json.text.split('\\n').length }}"
            },
            {
              "id": "meta_speakers",
              "name": "speakers",
              "type": "object",
              "value": "={{ $json.segments.map(s => s.speaker).filter((v, i, a) => a.indexOf(v) === i) }}"
            }
          ]
        }
      },
      "_comment": "Fireworks Whisper v3ã®å‡ºåŠ›ï¼ˆtext, duration, segmentsï¼‰ã‚’æ•´å½¢ã—ã€å¾Œç¶šå‡¦ç†ã§ä½¿ç”¨ã™ã‚‹ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’è¨­å®šã—ã¾ã™ã€‚transcriptï¼ˆå…¨æ–‡ï¼‰ã€duration_secondsï¼ˆéŸ³å£°æ™‚é–“ï¼‰ã€segmentsï¼ˆè©±è€…ãƒ»ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ä»˜ãã‚»ã‚°ãƒ¡ãƒ³ãƒˆï¼‰ã€total_linesï¼ˆè¡Œæ•°ï¼‰ã€speakersï¼ˆè©±è€…ãƒªã‚¹ãƒˆï¼‰ã‚’æŠ½å‡ºã—ã¾ã™ã€‚",
      "notes": "mode: manual | assignments: 5å€‹ (transcript, duration_seconds, segments, total_lines, speakers) | transcript: å…¨æ–‡ãƒ†ã‚­ã‚¹ãƒˆ | segments: è©±è€…ãƒ»ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—æƒ…å ± | speakers: ãƒ¦ãƒ‹ãƒ¼ã‚¯è©±è€…ãƒªã‚¹ãƒˆ"
    },
    {
      "id": "code_chunk_g2_03",
      "type": "n8n-nodes-base.code",
      "name": "ãƒãƒ£ãƒ³ã‚¯åˆ†å‰²å‡¦ç†",
      "typeVersion": 2,
      "position": [1800, 300],
      "parameters": {
        "mode": "runOnceForAllItems",
        "jsCode": "// æ–‡å­—èµ·ã“ã—ãƒ†ã‚­ã‚¹ãƒˆã‚’ãƒãƒ£ãƒ³ã‚¯åˆ†å‰²ï¼ˆ25è¡Œ + ã‚ªãƒ¼ãƒãƒ¼ãƒ©ãƒƒãƒ—6è¡Œï¼‰\nconst items = $input.all();\nconst chunks = [];\n\nfor (const item of items) {\n  const transcript = item.json.transcript;\n  const segments = item.json.segments || [];\n  const lines = transcript.split('\\n').filter(line => line.trim().length > 0);\n  \n  const CHUNK_SIZE = 25;\n  const OVERLAP = 6;\n  const chunkCount = Math.ceil(lines.length / (CHUNK_SIZE - OVERLAP));\n  \n  for (let i = 0; i < chunkCount; i++) {\n    const startIndex = i * (CHUNK_SIZE - OVERLAP);\n    const endIndex = Math.min(startIndex + CHUNK_SIZE, lines.length);\n    const chunkLines = lines.slice(startIndex, endIndex);\n    \n    // è©²å½“ã‚»ã‚°ãƒ¡ãƒ³ãƒˆæƒ…å ±ã‚’æŠ½å‡º\n    const chunkSegments = segments.filter(seg => {\n      const segmentText = seg.text || '';\n      return chunkLines.some(line => line.includes(segmentText));\n    });\n    \n    chunks.push({\n      json: {\n        ...item.json,\n        chunk_id: i + 1,\n        chunk_total: chunkCount,\n        chunk: chunkLines.join('\\n'),\n        chunk_lines: chunkLines.length,\n        chunk_start_line: startIndex + 1,\n        chunk_end_line: endIndex,\n        chunk_segments: chunkSegments,\n        has_overlap: i > 0\n      }\n    });\n  }\n}\n\nreturn chunks;"
      },
      "_comment": "æ–‡å­—èµ·ã“ã—ãƒ†ã‚­ã‚¹ãƒˆã‚’25è¡Œå˜ä½ã®ãƒãƒ£ãƒ³ã‚¯ã«åˆ†å‰²ã—ã€ãƒãƒ£ãƒ³ã‚¯é–“ã«6è¡Œã®ã‚ªãƒ¼ãƒãƒ¼ãƒ©ãƒƒãƒ—ã‚’è¨­ã‘æ–‡è„ˆã®é€£ç¶šæ€§ã‚’ä¿ã¡ã¾ã™ã€‚å„ãƒãƒ£ãƒ³ã‚¯ã«ã¯chunk_idï¼ˆç•ªå·ï¼‰ã€chunk_totalï¼ˆç·æ•°ï¼‰ã€chunkï¼ˆãƒ†ã‚­ã‚¹ãƒˆï¼‰ã€chunk_linesï¼ˆè¡Œæ•°ï¼‰ã€chunk_start_line/chunk_end_lineï¼ˆé–‹å§‹/çµ‚äº†è¡Œç•ªå·ï¼‰ã€chunk_segmentsï¼ˆè©²å½“ã‚»ã‚°ãƒ¡ãƒ³ãƒˆæƒ…å ±ï¼‰ã€has_overlapï¼ˆã‚ªãƒ¼ãƒãƒ¼ãƒ©ãƒƒãƒ—æœ‰ç„¡ï¼‰ã‚’ä»˜ä¸ã—ã¾ã™ã€‚",
      "notes": "mode: runOnceForAllItems | CHUNK_SIZE: 25è¡Œ | OVERLAP: 6è¡Œ | å‡ºåŠ›: chunk_id, chunk_total, chunk, chunk_lines, chunk_start_line, chunk_end_line, chunk_segments, has_overlap | ç›®çš„: AI Agent Step2ã®ä¸¦åˆ—å‡¦ç†æº–å‚™"
    },
    {
      "id": "split_batch_g2_04",
      "type": "n8n-nodes-base.splitInBatches",
      "name": "ãƒãƒ£ãƒ³ã‚¯ä¸¦åˆ—ãƒãƒƒãƒ",
      "typeVersion": 3,
      "position": [2000, 300],
      "parameters": {
        "batchSize": 5,
        "options": {}
      },
      "_comment": "ãƒãƒ£ãƒ³ã‚¯ã‚’5å€‹ãšã¤ãƒãƒƒãƒã«åˆ†å‰²ã—ã€AI Agent Step2ï¼ˆGroup 3ï¼‰ã§ä¸¦åˆ—å‡¦ç†ã—ã¾ã™ã€‚Output 1ï¼ˆãƒ«ãƒ¼ãƒ—ãƒãƒƒã‚¯ï¼‰ã§AI Agentã«é€ä¿¡ã—ã€å…¨ãƒãƒ£ãƒ³ã‚¯å‡¦ç†å®Œäº†å¾Œã«Output 0ã§æ¬¡ã®Group 4ï¼ˆãƒãƒ£ãƒ³ã‚¯çµ±åˆï¼‰ã«é€²ã¿ã¾ã™ã€‚5ä¸¦åˆ—å‡¦ç†ã«ã‚ˆã‚Šã€1æ™‚é–“éŸ³å£°ï¼ˆç´„10-20ãƒãƒ£ãƒ³ã‚¯ï¼‰ã‚’2-4åˆ†ã§æ•´å½¢å®Œäº†ã§ãã¾ã™ã€‚",
      "notes": "batchSize: 5 | Output 1: AI Agent Step2ã¸ãƒ«ãƒ¼ãƒ—ãƒãƒƒã‚¯ï¼ˆä¸¦åˆ—å‡¦ç†ï¼‰ | Output 0: å…¨ãƒãƒ£ãƒ³ã‚¯å®Œäº†å¾Œã€Group 4ï¼ˆMergeï¼‰ã¸ | ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹: 5ä¸¦åˆ—ã«ã‚ˆã‚Šå‡¦ç†æ™‚é–“å¤§å¹…çŸ­ç¸®"
    },
    {
      "id": "sticky_g2",
      "type": "n8n-nodes-base.stickyNote",
      "name": "Group 2: éŸ³å£°æ–‡å­—èµ·ã“ã—ãƒ»ãƒãƒ£ãƒ³ã‚¯åˆ†å‰²",
      "typeVersion": 1,
      "position": [1340, 140],
      "parameters": {
        "content": "## Group 2: éŸ³å£°æ–‡å­—èµ·ã“ã—ãƒ»ãƒãƒ£ãƒ³ã‚¯åˆ†å‰²\n\n**ç›®çš„**: Fireworks Whisper v3ã§M4AéŸ³å£°ã‚’è¶…é«˜é€Ÿæ–‡å­—èµ·ã“ã—ã—ã€ãƒãƒ£ãƒ³ã‚¯åˆ†å‰²ã§ä¸¦åˆ—å‡¦ç†æº–å‚™\n\n### ğŸ¯ ã“ã®ã‚°ãƒ«ãƒ¼ãƒ—ã®å½¹å‰²\n- **L4 (Transformation)**: éŸ³å£°â†’ãƒ†ã‚­ã‚¹ãƒˆå¤‰æ›ã€ãƒãƒ£ãƒ³ã‚¯åˆ†å‰²\n- **L6 (Integration)**: Fireworks AI APIé€£æº\n- **L11 (Performance)**: 5ä¸¦åˆ—ãƒãƒƒãƒå‡¦ç†\n\n### ğŸ“¦ ã“ã®ã‚°ãƒ«ãƒ¼ãƒ—ã«å«ã¾ã‚Œã‚‹ãƒãƒ¼ãƒ‰\n\n**1. Fireworks Whisper v3æ–‡å­—èµ·ã“ã—** (http_whisper_g2_01)\n- ã‚¿ã‚¤ãƒ—: HTTP Request\n- å½¹å‰²: M4AéŸ³å£°ã‚’æ—¥æœ¬èªæ–‡å­—èµ·ã“ã—ï¼ˆè©±è€…è­˜åˆ¥ä»˜ãï¼‰\n- è¨­å®š: POST https://api.fireworks.ai/v1/audio/transcriptions\n- ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿: model=whisper-v3-large, language=ja, diarization=true, response_format=verbose_json\n- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹: **1æ™‚é–“éŸ³å£°â†’4ç§’å‡¦ç†**ï¼ˆDeepgramæ¯”95%é«˜é€ŸåŒ–ã€ã‚³ã‚¹ãƒˆ99%å‰Šæ¸›ï¼‰\n\n**2. æ–‡å­—èµ·ã“ã—ãƒ¡ã‚¿æ•´å½¢** (set_meta_g2_02)\n- ã‚¿ã‚¤ãƒ—: Set\n- å½¹å‰²: Whisper v3å‡ºåŠ›ã‚’æ•´å½¢ã€ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿æŠ½å‡º\n- å‡ºåŠ›: transcriptï¼ˆå…¨æ–‡ï¼‰ã€duration_secondsã€segmentsï¼ˆè©±è€…æƒ…å ±ï¼‰ã€total_linesã€speakers\n\n**3. ãƒãƒ£ãƒ³ã‚¯åˆ†å‰²å‡¦ç†** (code_chunk_g2_03)\n- ã‚¿ã‚¤ãƒ—: Code\n- å½¹å‰²: ãƒ†ã‚­ã‚¹ãƒˆã‚’25è¡Œãƒãƒ£ãƒ³ã‚¯ã«åˆ†å‰²ï¼ˆã‚ªãƒ¼ãƒãƒ¼ãƒ©ãƒƒãƒ—6è¡Œï¼‰\n- å‡ºåŠ›: chunk_id, chunk_total, chunk, chunk_lines, chunk_start_line, chunk_end_line, chunk_segments, has_overlap\n- ç›®çš„: AI Agent Step2ã®ä¸¦åˆ—å‡¦ç†æº–å‚™\n\n**4. ãƒãƒ£ãƒ³ã‚¯ä¸¦åˆ—ãƒãƒƒãƒ** (split_batch_g2_04)\n- ã‚¿ã‚¤ãƒ—: Split In Batches\n- å½¹å‰²: 5ãƒãƒ£ãƒ³ã‚¯ãšã¤ãƒãƒƒãƒåˆ†å‰²ã€ä¸¦åˆ—å‡¦ç†é–‹å§‹\n- è¨­å®š: batchSize=5\n- Output 1: AI Agent Step2ã¸ãƒ«ãƒ¼ãƒ—ãƒãƒƒã‚¯\n- Output 0: å…¨ãƒãƒ£ãƒ³ã‚¯å®Œäº†å¾Œã€Group 4ï¼ˆMergeï¼‰ã¸\n\n### ğŸ”— ãƒ•ãƒ­ãƒ¼\n**Group 1** â†’ http_whisper_g2_01 â†’ set_meta_g2_02 â†’ code_chunk_g2_03 â†’ split_batch_g2_04 â†’ **Group 3 (AI Agent Step2)** â†’ ãƒ«ãƒ¼ãƒ—ãƒãƒƒã‚¯ â†’ split_batch_g2_04 â†’ **Group 4**\n\n### âš™ï¸ ä¾å­˜é–¢ä¿‚\n- **å…¥åŠ›**: Group 1ã‹ã‚‰M4Aãƒã‚¤ãƒŠãƒªãƒ‡ãƒ¼ã‚¿ï¼ˆ$binary.m4a_dataï¼‰\n- **å‡ºåŠ›**: ãƒãƒ£ãƒ³ã‚¯åŒ–ã•ã‚ŒãŸãƒ†ã‚­ã‚¹ãƒˆ â†’ Group 3ï¼ˆAI Agent Step2ï¼‰ã¸\n- **å¤–éƒ¨API**: Fireworks AI Whisper v3\n- **ä¸¦åˆ—å‡¦ç†**: 5ãƒãƒ£ãƒ³ã‚¯åŒæ™‚å‡¦ç†\n\n### ğŸ“Š ä¸»è¦ãƒ‡ãƒ¼ã‚¿\n- `$json.transcript`: å…¨æ–‡ãƒ†ã‚­ã‚¹ãƒˆ\n- `$json.duration_seconds`: éŸ³å£°æ™‚é–“ï¼ˆç§’ï¼‰\n- `$json.segments`: è©±è€…ãƒ»ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ä»˜ãã‚»ã‚°ãƒ¡ãƒ³ãƒˆé…åˆ—\n- `$json.total_lines`: ç·è¡Œæ•°\n- `$json.speakers`: è©±è€…ãƒªã‚¹ãƒˆ\n- `$json.chunk_id`: ãƒãƒ£ãƒ³ã‚¯ç•ªå·ï¼ˆ1, 2, 3...ï¼‰\n- `$json.chunk_total`: ç·ãƒãƒ£ãƒ³ã‚¯æ•°\n- `$json.chunk`: ãƒãƒ£ãƒ³ã‚¯ãƒ†ã‚­ã‚¹ãƒˆï¼ˆ25è¡Œï¼‰\n- `$json.chunk_lines`: ãƒãƒ£ãƒ³ã‚¯è¡Œæ•°\n- `$json.has_overlap`: ã‚ªãƒ¼ãƒãƒ¼ãƒ©ãƒƒãƒ—æœ‰ç„¡\n\n### ğŸ—ï¸ 12å±¤ãƒãƒƒãƒ”ãƒ³ã‚°\n- **L4 (Transformation)**: set_meta_g2_02, code_chunk_g2_03\n- **L6 (Integration)**: http_whisper_g2_01ï¼ˆFireworks APIï¼‰\n- **L11 (Performance)**: split_batch_g2_04ï¼ˆ5ä¸¦åˆ—ãƒãƒƒãƒï¼‰\n\n### âš¡ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç‰¹æ€§\n- **æ–‡å­—èµ·ã“ã—é€Ÿåº¦**: 1æ™‚é–“éŸ³å£°â†’4ç§’ï¼ˆDeepgramæ¯”95%é«˜é€ŸåŒ–ï¼‰\n- **ã‚³ã‚¹ãƒˆå‰Šæ¸›**: 99%å‰Šæ¸›ï¼ˆStep010æ¥­å‹™ç†è§£æ›¸æº–æ‹ ï¼‰\n- **ä¸¦åˆ—å‡¦ç†**: 5ãƒãƒ£ãƒ³ã‚¯åŒæ™‚â†’å‡¦ç†æ™‚é–“å¤§å¹…çŸ­ç¸®\n- **ã‚ªãƒ¼ãƒãƒ¼ãƒ©ãƒƒãƒ—**: 6è¡Œã§æ–‡è„ˆé€£ç¶šæ€§ç¢ºä¿",
        "height": 540,
        "width": 640,
        "color": 3
      }
    }
  ],
  "connections": {
    "Fireworks Whisper v3æ–‡å­—èµ·ã“ã—": {
      "main": [
        [
          {
            "node": "æ–‡å­—èµ·ã“ã—ãƒ¡ã‚¿æ•´å½¢",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æ–‡å­—èµ·ã“ã—ãƒ¡ã‚¿æ•´å½¢": {
      "main": [
        [
          {
            "node": "ãƒãƒ£ãƒ³ã‚¯åˆ†å‰²å‡¦ç†",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ãƒãƒ£ãƒ³ã‚¯åˆ†å‰²å‡¦ç†": {
      "main": [
        [
          {
            "node": "ãƒãƒ£ãƒ³ã‚¯ä¸¦åˆ—ãƒãƒƒãƒ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "pinData": {},
  "settings": {
    "executionOrder": "v1"
  },
  "staticData": null,
  "tags": [],
  "triggerCount": 0,
  "updatedAt": "2025-11-13T00:00:00.000Z",
  "versionId": "v4.0"
}
